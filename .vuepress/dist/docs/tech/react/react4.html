<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Reactï¼ˆå››ï¼‰</title>
    <meta name="generator" content="VuePress 1.9.10">
    
    <meta name="description" content="">
    
    <link rel="preload" href="/assets/css/0.styles.0503e0f3.css" as="style"><link rel="preload" href="/assets/js/app.3979e060.js" as="script"><link rel="preload" href="/assets/js/2.0f8cbb55.js" as="script"><link rel="preload" href="/assets/js/1.ff82b27c.js" as="script"><link rel="preload" href="/assets/js/68.58c65f95.js" as="script"><link rel="prefetch" href="/assets/js/10.d9850768.js"><link rel="prefetch" href="/assets/js/100.a33654f4.js"><link rel="prefetch" href="/assets/js/101.d3bc1c79.js"><link rel="prefetch" href="/assets/js/102.02bbfd1e.js"><link rel="prefetch" href="/assets/js/103.c9de5560.js"><link rel="prefetch" href="/assets/js/104.7c2b76db.js"><link rel="prefetch" href="/assets/js/105.ea3ac79c.js"><link rel="prefetch" href="/assets/js/106.d54e3045.js"><link rel="prefetch" href="/assets/js/107.c142f695.js"><link rel="prefetch" href="/assets/js/108.fe2c9c19.js"><link rel="prefetch" href="/assets/js/109.59b55101.js"><link rel="prefetch" href="/assets/js/11.62caceeb.js"><link rel="prefetch" href="/assets/js/110.c657b6f8.js"><link rel="prefetch" href="/assets/js/111.4eadf9c5.js"><link rel="prefetch" href="/assets/js/112.fce38ecf.js"><link rel="prefetch" href="/assets/js/113.ee6322e2.js"><link rel="prefetch" href="/assets/js/114.1ed20fd8.js"><link rel="prefetch" href="/assets/js/115.aa405ee0.js"><link rel="prefetch" href="/assets/js/116.d1b4c413.js"><link rel="prefetch" href="/assets/js/117.965d1926.js"><link rel="prefetch" href="/assets/js/118.b1d5b9ca.js"><link rel="prefetch" href="/assets/js/119.e4e766bc.js"><link rel="prefetch" href="/assets/js/12.abd8d9de.js"><link rel="prefetch" href="/assets/js/120.f569b061.js"><link rel="prefetch" href="/assets/js/121.e3915f79.js"><link rel="prefetch" href="/assets/js/122.3a2b3d34.js"><link rel="prefetch" href="/assets/js/123.cbf985ea.js"><link rel="prefetch" href="/assets/js/124.c3d8b6fc.js"><link rel="prefetch" href="/assets/js/125.dfe970a3.js"><link rel="prefetch" href="/assets/js/126.f5165054.js"><link rel="prefetch" href="/assets/js/127.ffb31d35.js"><link rel="prefetch" href="/assets/js/128.bf7eb0b3.js"><link rel="prefetch" href="/assets/js/129.76b0ac54.js"><link rel="prefetch" href="/assets/js/13.763c094c.js"><link rel="prefetch" href="/assets/js/130.cb661ef6.js"><link rel="prefetch" href="/assets/js/131.b215b4cc.js"><link rel="prefetch" href="/assets/js/132.bdf6b89f.js"><link rel="prefetch" href="/assets/js/133.a13e43ca.js"><link rel="prefetch" href="/assets/js/134.f858c56e.js"><link rel="prefetch" href="/assets/js/135.0e05a297.js"><link rel="prefetch" href="/assets/js/136.ff47beeb.js"><link rel="prefetch" href="/assets/js/137.7dcf182f.js"><link rel="prefetch" href="/assets/js/138.dd2c3c8c.js"><link rel="prefetch" href="/assets/js/139.db36e4eb.js"><link rel="prefetch" href="/assets/js/14.784100b6.js"><link rel="prefetch" href="/assets/js/140.05811a56.js"><link rel="prefetch" href="/assets/js/141.32b8052b.js"><link rel="prefetch" href="/assets/js/142.2c061186.js"><link rel="prefetch" href="/assets/js/143.113df61a.js"><link rel="prefetch" href="/assets/js/144.2c01c336.js"><link rel="prefetch" href="/assets/js/145.a8fe7a8a.js"><link rel="prefetch" href="/assets/js/146.bb5b7e16.js"><link rel="prefetch" href="/assets/js/147.213b17a7.js"><link rel="prefetch" href="/assets/js/148.dd7a3258.js"><link rel="prefetch" href="/assets/js/149.b3f9adc5.js"><link rel="prefetch" href="/assets/js/15.3aa73286.js"><link rel="prefetch" href="/assets/js/150.4ab9a505.js"><link rel="prefetch" href="/assets/js/151.d04eb475.js"><link rel="prefetch" href="/assets/js/152.c547ae2c.js"><link rel="prefetch" href="/assets/js/153.3fa58002.js"><link rel="prefetch" href="/assets/js/154.cd2cc012.js"><link rel="prefetch" href="/assets/js/155.0160c441.js"><link rel="prefetch" href="/assets/js/16.7886627b.js"><link rel="prefetch" href="/assets/js/17.a4c76a6c.js"><link rel="prefetch" href="/assets/js/18.995eb54b.js"><link rel="prefetch" href="/assets/js/19.edc682a7.js"><link rel="prefetch" href="/assets/js/20.87ca556d.js"><link rel="prefetch" href="/assets/js/21.4b328dcc.js"><link rel="prefetch" href="/assets/js/22.91d15e78.js"><link rel="prefetch" href="/assets/js/23.17bfc3dd.js"><link rel="prefetch" href="/assets/js/24.c0d84a10.js"><link rel="prefetch" href="/assets/js/25.2717e191.js"><link rel="prefetch" href="/assets/js/26.3764ddb4.js"><link rel="prefetch" href="/assets/js/27.e98913ec.js"><link rel="prefetch" href="/assets/js/28.a4481108.js"><link rel="prefetch" href="/assets/js/29.3d82d38d.js"><link rel="prefetch" href="/assets/js/3.e2aae122.js"><link rel="prefetch" href="/assets/js/30.7e9979a2.js"><link rel="prefetch" href="/assets/js/31.fa479c29.js"><link rel="prefetch" href="/assets/js/32.901576de.js"><link rel="prefetch" href="/assets/js/33.8dafc45c.js"><link rel="prefetch" href="/assets/js/34.6bbddd9b.js"><link rel="prefetch" href="/assets/js/35.394c80b9.js"><link rel="prefetch" href="/assets/js/36.5246333d.js"><link rel="prefetch" href="/assets/js/37.49802bfd.js"><link rel="prefetch" href="/assets/js/38.36ae0914.js"><link rel="prefetch" href="/assets/js/39.791184a0.js"><link rel="prefetch" href="/assets/js/4.30c2ba05.js"><link rel="prefetch" href="/assets/js/40.eb1a9cc1.js"><link rel="prefetch" href="/assets/js/41.31179942.js"><link rel="prefetch" href="/assets/js/42.22c31ea4.js"><link rel="prefetch" href="/assets/js/43.e82e343d.js"><link rel="prefetch" href="/assets/js/44.95e68751.js"><link rel="prefetch" href="/assets/js/45.b99232d2.js"><link rel="prefetch" href="/assets/js/46.21e9dae9.js"><link rel="prefetch" href="/assets/js/47.e30bba7c.js"><link rel="prefetch" href="/assets/js/48.6c0d14cd.js"><link rel="prefetch" href="/assets/js/49.ed1b480b.js"><link rel="prefetch" href="/assets/js/5.c5fba3ad.js"><link rel="prefetch" href="/assets/js/50.f500b9ed.js"><link rel="prefetch" href="/assets/js/51.3671246f.js"><link rel="prefetch" href="/assets/js/52.7915148f.js"><link rel="prefetch" href="/assets/js/53.39ece5d9.js"><link rel="prefetch" href="/assets/js/54.358ca4aa.js"><link rel="prefetch" href="/assets/js/55.244837be.js"><link rel="prefetch" href="/assets/js/56.e7164f10.js"><link rel="prefetch" href="/assets/js/57.3c6f5aa2.js"><link rel="prefetch" href="/assets/js/58.84c83603.js"><link rel="prefetch" href="/assets/js/59.ec4edc7d.js"><link rel="prefetch" href="/assets/js/6.9184d4d1.js"><link rel="prefetch" href="/assets/js/60.c2346e02.js"><link rel="prefetch" href="/assets/js/61.8d99ca4c.js"><link rel="prefetch" href="/assets/js/62.f6bea4bf.js"><link rel="prefetch" href="/assets/js/63.410bfe1e.js"><link rel="prefetch" href="/assets/js/64.960d5951.js"><link rel="prefetch" href="/assets/js/65.e6a8895b.js"><link rel="prefetch" href="/assets/js/66.41092e16.js"><link rel="prefetch" href="/assets/js/67.062b95dc.js"><link rel="prefetch" href="/assets/js/69.d1e1b68b.js"><link rel="prefetch" href="/assets/js/7.85fc951e.js"><link rel="prefetch" href="/assets/js/70.8294a611.js"><link rel="prefetch" href="/assets/js/71.66e44dac.js"><link rel="prefetch" href="/assets/js/72.46bd34f2.js"><link rel="prefetch" href="/assets/js/73.7eb2e800.js"><link rel="prefetch" href="/assets/js/74.8e05f264.js"><link rel="prefetch" href="/assets/js/75.21e0b9b1.js"><link rel="prefetch" href="/assets/js/76.c2c92cec.js"><link rel="prefetch" href="/assets/js/77.799df679.js"><link rel="prefetch" href="/assets/js/78.1605b33c.js"><link rel="prefetch" href="/assets/js/79.659e7e78.js"><link rel="prefetch" href="/assets/js/80.6f99ca65.js"><link rel="prefetch" href="/assets/js/81.7a0caba9.js"><link rel="prefetch" href="/assets/js/82.19629840.js"><link rel="prefetch" href="/assets/js/83.29093f51.js"><link rel="prefetch" href="/assets/js/84.64568258.js"><link rel="prefetch" href="/assets/js/85.3d88e3b2.js"><link rel="prefetch" href="/assets/js/86.0a93f933.js"><link rel="prefetch" href="/assets/js/87.07c51a25.js"><link rel="prefetch" href="/assets/js/88.aa6be8e5.js"><link rel="prefetch" href="/assets/js/89.6ad93f1f.js"><link rel="prefetch" href="/assets/js/90.87c8c6e5.js"><link rel="prefetch" href="/assets/js/91.57c509b5.js"><link rel="prefetch" href="/assets/js/92.c8b02e25.js"><link rel="prefetch" href="/assets/js/93.fee86c6c.js"><link rel="prefetch" href="/assets/js/94.ab3bad19.js"><link rel="prefetch" href="/assets/js/95.cfaa79dc.js"><link rel="prefetch" href="/assets/js/96.c63afef5.js"><link rel="prefetch" href="/assets/js/97.123374a6.js"><link rel="prefetch" href="/assets/js/98.53cfb154.js"><link rel="prefetch" href="/assets/js/99.8fe1f067.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.5e19b665.js">
    <link rel="stylesheet" href="/assets/css/0.styles.0503e0f3.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <!----> </aside> <main class="page"> <div class="theme-default-content content__default"><p>â€‹      å‰ç«¯æ¡†æ¶ï¼Œå¿«é€Ÿå¼€å‘é¡µé¢ï¼Œå‡½æ•°å¼ç¼–ç¨‹ï¼Œä¸åç«¯apiå¿«é€Ÿæ­å»º</p> <h2 id="hooks-åŸç†"><a href="#hooks-åŸç†" class="header-anchor">#</a> Hooks åŸç†</h2> <h3 id="hooksä¸é—­åŒ…"><a href="#hooksä¸é—­åŒ…" class="header-anchor">#</a> hooksä¸é—­åŒ…</h3> <p><strong>é—­åŒ…æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„å¯¹è±¡</strong></p> <p><strong>å®ƒç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼Œæ‰§è¡Œä¸Šä¸‹æ–‡Aä»¥åŠåœ¨Aä¸­åˆ›å»ºçš„å‡½æ•°B</strong>ã€‚</p> <p><strong>å½“Bæ‰§è¡Œæ—¶ï¼Œå¦‚æœè®¿é—®äº†Aä¸­çš„å˜é‡å¯¹è±¡ï¼Œé‚£ä¹ˆé—­åŒ…å°±ä¼šäº§ç”Ÿã€‚</strong></p> <p><strong>æœ¬è´¨ä¸Šï¼ŒJavaScriptä¸­å¹¶æ²¡æœ‰è‡ªå·±çš„æ¨¡å—æ¦‚å¿µï¼Œæˆ‘ä»¬åªèƒ½ä½¿ç”¨å‡½æ•°/è‡ªæ‰§è¡Œå‡½æ•°æ¥æ¨¡æ‹Ÿæ¨¡å—ã€‚</strong></p> <p>ç°åœ¨çš„å‰ç«¯å·¥ç¨‹ä¸­ï¼ˆES6çš„æ¨¡å—è¯­æ³•è§„èŒƒï¼‰ï¼Œä½¿ç”¨çš„æ¨¡å—ï¼Œæœ¬è´¨ä¸Šéƒ½æ˜¯å‡½æ•°æˆ–è€…è‡ªæ‰§è¡Œå‡½æ•°ã€‚</p> <p>webpackç­‰æ‰“åŒ…å·¥å…·ä¼šå¸®åŠ©æˆ‘ä»¬å°†å…¶æ‰“åŒ…æˆä¸ºå‡½æ•°</p> <p>åœ¨reactä¸­ï¼Œä¸€ä¸ªå‡½æ•°ç»„ä»¶è°ƒç”¨å¦ä¸€ä¸ªå‡½æ•°ç»„ä»¶ï¼Œå°±å¿…ç„¶äº§ç”Ÿé—­åŒ…</p> <p>æ¯”å¦‚è¯´</p> <div class="language-react extra-class"><pre class="language-text"><code>// Counter.jsx
export default function Counter() {}


// App.jsx
import Counter from './Counter';
export default function App() {
 // todo
   return (
    &lt;Counter /&gt;
  )
}
</code></pre></div><p>è½¬æ¢æˆä¼ªä»£ç </p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>
<span class="token keyword">const</span> CounterModule <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token function">Counter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> AppModule <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> Counter <span class="token operator">=</span> CounterModule<span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">Counter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>æ¯ä¸€ä¸ªJSæ¨¡å—éƒ½å¯ä»¥è®¤ä¸ºæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„ä½œç”¨åŸŸï¼Œå½“ä»£ç æ‰§è¡Œæ—¶ï¼Œè¯¥è¯æ³•ä½œç”¨åŸŸåˆ›å»ºæ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œå¦‚æœåœ¨æ¨¡å—å†…éƒ¨ï¼Œåˆ›å»ºäº†å¯ä¾›å¤–éƒ¨å¼•ç”¨è®¿é—®çš„å‡½æ•°æ—¶ï¼Œå°±ä¸ºé—­åŒ…çš„äº§ç”Ÿæä¾›äº†æ¡ä»¶ï¼Œåªè¦è¯¥å‡½æ•°åœ¨å¤–éƒ¨æ‰§è¡Œè®¿é—®äº†æ¨¡å—å†…éƒ¨çš„å…¶ä»–å˜é‡ï¼Œé—­åŒ…å°±ä¼šäº§ç”Ÿã€‚</strong></p> <p>é‚£hookså‘¢ï¼Ÿ</p> <p>useStateçš„ç®€å•ä»£ç å¦‚ä¸‹</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// state.js</span>
<span class="token keyword">let</span> state <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">useState</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">value</span><span class="token operator">:</span> number</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// ç¬¬ä¸€æ¬¡è°ƒç”¨æ—¶æ²¡æœ‰åˆå§‹å€¼ï¼Œå› æ­¤ä½¿ç”¨ä¼ å…¥çš„åˆå§‹å€¼èµ‹å€¼</span>
  state <span class="token operator">=</span> state <span class="token operator">||</span> value<span class="token punctuation">;</span>

  <span class="token keyword">function</span> <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token parameter">newValue</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    state <span class="token operator">=</span> newValue<span class="token punctuation">;</span>
    <span class="token comment">// å‡è®¾æ­¤æ–¹æ³•èƒ½è§¦å‘é¡µé¢æ¸²æŸ“</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token punctuation">[</span>state<span class="token punctuation">,</span> dispatch<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>åœ¨å…¶ä»–æ¨¡å—ä¸­å¼•å…¥æ—¶</p> <div class="language-react extra-class"><pre class="language-text"><code>import React from 'react';
import {useState} from './state';

function Demo() {
  // ä½¿ç”¨æ•°ç»„è§£æ„çš„æ–¹å¼ï¼Œå®šä¹‰å˜é‡
  const [counter, setCounter] = useState(0);

  return (
    &lt;div onClick={() =&gt; setCounter(counter + 1)}&gt;hello world, {counter}&lt;/div&gt;
  )
}

export default Demo();
</code></pre></div><p><strong>å½“useStateåœ¨Demoä¸­æ‰§è¡Œæ—¶ï¼Œè®¿é—®äº†stateä¸­çš„å˜é‡å¯¹è±¡ï¼Œé‚£ä¹ˆé—­åŒ…å°±ä¼šäº§ç”Ÿ</strong>ã€‚</p> <p>æ ¹æ®é—­åŒ…çš„ç‰¹æ€§ï¼Œstateæ¨¡å—ä¸­çš„stateå˜é‡ï¼Œä¼šæŒä¹…å­˜åœ¨ã€‚å› æ­¤å½“Demoå‡½æ•°å†æ¬¡æ‰§è¡Œæ—¶ï¼Œæˆ‘ä»¬ä¹Ÿèƒ½è·å–åˆ°ä¸Šä¸€æ¬¡Demoå‡½æ•°æ‰§è¡Œç»“æŸæ—¶stateçš„å€¼ã€‚</p> <p>https://mp.weixin.qq.com/s/IMgHzeDXIbxMsVomnqx7AQ</p> <h3 id="hookçš„ä½¿ç”¨è§„åˆ™"><a href="#hookçš„ä½¿ç”¨è§„åˆ™" class="header-anchor">#</a> hookçš„ä½¿ç”¨è§„åˆ™</h3> <p>hookæœ‰ä»¥ä¸‹ä½¿ç”¨è§„åˆ™ï¼š</p> <ol><li>ä¸è¦åœ¨å¾ªç¯ï¼Œæ¡ä»¶æˆ–åµŒå¥—å‡½æ•°ä¸­è°ƒç”¨ Hook</li> <li>ç¡®ä¿æ€»æ˜¯åœ¨ä½ çš„ React å‡½æ•°çš„æœ€é¡¶å±‚è°ƒç”¨ä»–ä»¬ã€‚</li> <li>é¡ºåºè°ƒç”¨ã€‚éµå®ˆè¿™æ¡è§„åˆ™ï¼Œä½ å°±èƒ½ç¡®ä¿ Hook åœ¨æ¯ä¸€æ¬¡æ¸²æŸ“ä¸­éƒ½æŒ‰ç…§åŒæ ·çš„é¡ºåºè¢«è°ƒç”¨ã€‚è¿™è®© React èƒ½å¤Ÿåœ¨å¤šæ¬¡çš„ useState å’Œ useEffect è°ƒç”¨ä¹‹é—´ä¿æŒ hook çŠ¶æ€çš„æ­£ç¡®ã€‚</li></ol> <p>åœ¨å•ä¸ªç»„ä»¶ä¸­å¯ä»¥ä½¿ç”¨å¤šä¸ª State Hook æˆ– Effect Hookï¼Œä½†æ˜¯React æ€ä¹ˆçŸ¥é“å“ªä¸ª state å¯¹åº”å“ªä¸ª <code>useState</code>ï¼Ÿç­”æ¡ˆæ˜¯ React é çš„æ˜¯ Hook è°ƒç”¨çš„é¡ºåºã€‚å› ä¸ºæˆ‘ä»¬çš„ç¤ºä¾‹ä¸­ï¼ŒHook çš„è°ƒç”¨é¡ºåºåœ¨æ¯æ¬¡æ¸²æŸ“ä¸­éƒ½æ˜¯ç›¸åŒçš„ï¼Œæ‰€ä»¥å®ƒèƒ½å¤Ÿæ­£å¸¸å·¥ä½œã€‚åªè¦ Hook çš„è°ƒç”¨é¡ºåºåœ¨å¤šæ¬¡æ¸²æŸ“ä¹‹é—´ä¿æŒä¸€è‡´ï¼ŒReact å°±èƒ½æ­£ç¡®åœ°å°†å†…éƒ¨ state å’Œå¯¹åº”çš„ Hook è¿›è¡Œå…³è”ã€‚</p> <p>å¦‚æœåœ¨è¯­å¥ä¸­ä½¿ç”¨hook</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code> <span class="token comment">// ğŸ”´ åœ¨æ¡ä»¶è¯­å¥ä¸­ä½¿ç”¨ Hook è¿åç¬¬ä¸€æ¡è§„åˆ™</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>name <span class="token operator">!==</span> <span class="token string">''</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">persistForm</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      localStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">'formData'</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre></div><p>åœ¨ç¬¬ä¸€æ¬¡æ¸²æŸ“ä¸­ <code>name !== ''</code> è¿™ä¸ªæ¡ä»¶å€¼ä¸º <code>true</code>ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¼šæ‰§è¡Œè¿™ä¸ª Hookã€‚ä½†æ˜¯ä¸‹ä¸€æ¬¡æ¸²æŸ“æ—¶æˆ‘ä»¬å¯èƒ½æ¸…ç©ºäº†è¡¨å•ï¼Œè¡¨è¾¾å¼å€¼å˜ä¸º <code>false</code>ã€‚æ­¤æ—¶çš„æ¸²æŸ“ä¼šè·³è¿‡è¯¥ Hookï¼ŒHook çš„è°ƒç”¨é¡ºåºå‘ç”Ÿäº†æ”¹å˜ï¼š</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">'Mary'</span><span class="token punctuation">)</span>           <span class="token comment">// 1. è¯»å–å˜é‡åä¸º name çš„ stateï¼ˆå‚æ•°è¢«å¿½ç•¥ï¼‰</span>
<span class="token comment">// useEffect(persistForm)  // ğŸ”´ æ­¤ Hook è¢«å¿½ç•¥ï¼</span>
<span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">'Poppins'</span><span class="token punctuation">)</span>        <span class="token comment">// ğŸ”´ 2 ï¼ˆä¹‹å‰ä¸º 3ï¼‰ã€‚è¯»å–å˜é‡åä¸º surname çš„ state å¤±è´¥</span>
<span class="token function">useEffect</span><span class="token punctuation">(</span>updateTitle<span class="token punctuation">)</span>     <span class="token comment">// ğŸ”´ 3 ï¼ˆä¹‹å‰ä¸º 4ï¼‰ã€‚æ›¿æ¢æ›´æ–°æ ‡é¢˜çš„ effect å¤±è´¥</span>
</code></pre></div><p>React ä¸çŸ¥é“ç¬¬äºŒä¸ª <code>useState</code> çš„ Hook åº”è¯¥è¿”å›ä»€ä¹ˆã€‚React ä¼šä»¥ä¸ºåœ¨è¯¥ç»„ä»¶ä¸­ç¬¬äºŒä¸ª Hook çš„è°ƒç”¨åƒä¸Šæ¬¡çš„æ¸²æŸ“ä¸€æ ·ï¼Œå¯¹åº”çš„æ˜¯ <code>persistForm</code> çš„ effectï¼Œä½†å¹¶éå¦‚æ­¤ã€‚ä»è¿™é‡Œå¼€å§‹ï¼Œåé¢çš„ Hook è°ƒç”¨éƒ½è¢«æå‰æ‰§è¡Œï¼Œå¯¼è‡´ bug çš„äº§ç”Ÿã€‚</p> <h4 id="ä¸ºä»€ä¹ˆä¸èƒ½åœ¨æ¡ä»¶è¯­å¥å’Œå¾ªç¯è¯­å¥ä¸­ä½¿ç”¨hook"><a href="#ä¸ºä»€ä¹ˆä¸èƒ½åœ¨æ¡ä»¶è¯­å¥å’Œå¾ªç¯è¯­å¥ä¸­ä½¿ç”¨hook" class="header-anchor">#</a> ä¸ºä»€ä¹ˆä¸èƒ½åœ¨æ¡ä»¶è¯­å¥å’Œå¾ªç¯è¯­å¥ä¸­ä½¿ç”¨hook</h4> <p>react hookæ‰§è¡Œæ—¶ä»¥æ•°ç»„çš„ç»“æ„æ‰§è¡Œï¼ŒæŒ‰é¡ºåºæ‰§è¡Œï¼Œå¦‚æœä½¿ç”¨æ¡ä»¶è¯­å¥å°±ä¼šå‡ºç°ç¼ºå°‘æŸä¸€ä¸ªhookï¼Œç„¶åå‡ºç°é”™ä½å¯¼è‡´é”™è¯¯ã€‚</p> <p>react hookåº•å±‚æ˜¯é“¾è¡¨ï¼Œæ¯ä¸€ä¸ªhookçš„nextæ˜¯æŒ‡å‘ä¸‹ä¸€ä¸ªhookçš„ï¼Œifä¼šå¯¼è‡´é¡ºåºä¸æ­£ç¡®ï¼Œä»è€Œå¯¼è‡´æŠ¥é”™ï¼Œæ‰€ä»¥reactæ˜¯ä¸å…è®¸è¿™æ ·ä½¿ç”¨hookçš„ã€‚</p> <p>å¾ªç¯è¯­å¥ä¹Ÿæ˜¯ä¸€æ ·ï¼Œä¸èƒ½ç»å¯¹ä¿è¯hookçš„æ‰§è¡Œé¡ºåºã€‚å¦‚æœéè¦åœ¨å¾ªç¯ä¸­ä½¿ç”¨ï¼Œå¯ä»¥ä½¿ç”¨reactå®˜æ–¹çš„lint</p> <h3 id="hookçš„é—­åŒ…é™·é˜±-useeffectä¸­å®šæ—¶å™¨çš„ä½¿ç”¨-è¿‡æœŸé—­åŒ…"><a href="#hookçš„é—­åŒ…é™·é˜±-useeffectä¸­å®šæ—¶å™¨çš„ä½¿ç”¨-è¿‡æœŸé—­åŒ…" class="header-anchor">#</a> Hookçš„é—­åŒ…é™·é˜±(useEffectä¸­å®šæ—¶å™¨çš„ä½¿ç”¨ï¼Œè¿‡æœŸé—­åŒ…)</h3> <p>é—­åŒ…é™·é˜±å°±æ˜¯åœ¨React Hookè¿›è¡Œå¼€å‘æ—¶ï¼Œé€šè¿‡useStateå®šä¹‰çš„å€¼æ‹¿åˆ°çš„éƒ½ä¸æ˜¯æœ€æ–°çš„å€¼</p> <p>ä¸Šä»£ç </p> <div class="language-react extra-class"><pre class="language-text"><code>const App = () =&gt;{
   const [count,setCount] = useState(0)
   useEffect(()=&gt;{
     const timeId = setInterval(()=&gt;{
        setCount(count+1)
     },1000)
     return ()=&gt;{clearInterval(timeId)}
   },[])
   return (
      &lt;span&gt;{count}&lt;/span&gt;
   )
}
</code></pre></div><p>ä¸Šé¢çš„ä»£ç ä¸­ï¼Œcountå¹¶ä¸ä¼šå’Œç†æƒ³ä¸­ä¸€æ ·æ¯è¿‡ä¸€ç§’è‡ªåŠ¨+1å¹¶æ›´æ–°DOMï¼Œè€Œæ˜¯ä»0å˜æˆ1åï¼Œconsoleæ‰“å°å‡ºçš„countä¸€ç›´æ˜¯è®¾ç«‹çš„é»˜è®¤å€¼0</p> <p>å› ä¸ºuseEffectçš„ä¾èµ–æ•°ç»„æ˜¯ç©ºæ•°ç»„ï¼Œé‚£setIntervalé‡Œé¢çš„countæ˜¯é€šè¿‡é—­åŒ…å–å¾—çš„å€¼ï¼Œä»–è¯»å–åˆ°çš„ç¬¬ä¸€æ¬¡çš„countï¼Œå¹¶ä¸”useEffectå¹¶æ²¡æœ‰æ›´æ–°ï¼Œå› ä¸ºæ¯æ¬¡éƒ½æ˜¯0</p> <p>å¦‚æœå»æ‰useEffectçš„ä¾èµ–æ•°ç»„å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œç„¶è€Œä¼šé€ æˆæ¯æ¬¡Appç»„ä»¶æ¸²æŸ“éƒ½ä¼šè¿è¡ŒuseEffecté‡Œé¢çš„å‡½æ•°ï¼Œå°±ä¼šé€ æˆä¸å¿…è¦çš„æµªè´¹å’Œéšè—çš„bug</p> <h4 id="äº§ç”Ÿçš„åŸå› "><a href="#äº§ç”Ÿçš„åŸå› " class="header-anchor">#</a> äº§ç”Ÿçš„åŸå› </h4> <p>Reactä»react16ä¹‹åï¼Œæ›´æ¢äº†fiberæ¶æ„ï¼Œå¼•å…¥äº†hooksã€‚Fiberæ¶æ„ä¸­ï¼Œä¸€ä¸ª FiberèŠ‚ç‚¹å°±å¯¹åº”çš„æ˜¯ä¸€ä¸ªç»„ä»¶ã€‚å¯¹äº <code>classComponent</code> è€Œè¨€ï¼Œæœ‰ <code>state</code> æ˜¯ä¸€ä»¶å¾ˆæ­£å¸¸çš„äº‹æƒ…ï¼ŒFiberå¯¹è±¡ä¸Šæœ‰ä¸€ä¸ª <code>memoizedState</code> ç”¨äºå­˜æ”¾ç»„ä»¶çš„ <code>state</code>ã€‚okï¼Œç°åœ¨çœ‹ hooks æ‰€é’ˆå¯¹çš„ <code>FunctionComponnet</code>ã€‚ æ— è®ºå¼€å‘è€…æ€ä¹ˆæŠ˜è…¾ï¼Œä¸€ä¸ªå¯¹è±¡éƒ½åªèƒ½æœ‰ä¸€ä¸ª <code>state</code> å±æ€§æˆ–è€… <code>memoizedState</code>  å±æ€§ï¼Œå¯æ˜¯ï¼Œè°çŸ¥é“å¯çˆ±çš„å¼€å‘è€…ä»¬ä¼šåœ¨ <code>FunctionComponent</code> é‡Œå†™ä¸Šå¤šå°‘ä¸ª <code>useState</code>ï¼Œ<code>useEffect</code> ç­‰ç­‰ ? æ‰€ä»¥ï¼Œreactç”¨äº†é“¾è¡¨è¿™ç§æ•°æ®ç»“æ„æ¥å­˜å‚¨ <code>FunctionComponent</code> é‡Œé¢çš„ hooks</p> <p>æ¯”å¦‚</p> <div class="language-react extra-class"><pre class="language-text"><code>function App(){
    const [count, setCount] = useState(1)
    const [name, setName] = useState('chechengyi')
    useEffect(()=&gt;{
        
    }, [])
    const text = useMemo(()=&gt;{
        return 'ddd'
    }, [])
}
</code></pre></div><p>åœ¨ç»„ä»¶ç¬¬ä¸€æ¬¡æ¸²æŸ“çš„æ—¶å€™ï¼Œä¸ºæ¯ä¸ªhookséƒ½åˆ›å»ºäº†ä¸€ä¸ªå¯¹è±¡</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">type</span> <span class="token class-name">Hook</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  memoizedState<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span>
  baseState<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span>
  baseUpdate<span class="token operator">:</span> Update<span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token punctuation">,</span> <span class="token builtin">any</span><span class="token operator">&gt;</span> <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
  queue<span class="token operator">:</span> UpdateQueue<span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token punctuation">,</span> <span class="token builtin">any</span><span class="token operator">&gt;</span> <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
  next<span class="token operator">:</span> Hook <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>è¿™ä¸ªå¯¹è±¡çš„<code>memoizedState</code>å±æ€§å°±æ˜¯ç”¨æ¥å­˜å‚¨ç»„ä»¶ä¸Šä¸€æ¬¡æ›´æ–°åçš„ <code>state</code>,<code>next</code>æ¯«æ— ç–‘é—®æ˜¯æŒ‡å‘ä¸‹ä¸€ä¸ªhookå¯¹è±¡ã€‚åœ¨ç»„ä»¶æ›´æ–°çš„è¿‡ç¨‹ä¸­ï¼Œhookså‡½æ•°æ‰§è¡Œçš„é¡ºåºæ˜¯ä¸å˜çš„ï¼Œå°±å¯ä»¥æ ¹æ®è¿™ä¸ªé“¾è¡¨æ‹¿åˆ°å½“å‰hookså¯¹åº”çš„<code>Hook</code>å¯¹è±¡ï¼Œå‡½æ•°å¼ç»„ä»¶å°±æ˜¯è¿™æ ·æ‹¥æœ‰äº†stateçš„èƒ½åŠ›ã€‚</p> <p>æ‰€ä»¥hooksä¸èƒ½å†™åˆ°if elseè¯­å¥ä¸­äº†ã€‚å› ä¸ºè¿™æ ·å¯èƒ½ä¼šå¯¼è‡´é¡ºåºé”™ä¹±ï¼Œå¯¼è‡´å½“å‰hooksæ‹¿åˆ°çš„ä¸æ˜¯è‡ªå·±å¯¹åº”çš„Hookå¯¹è±¡ã€‚</p> <p>å›åˆ°useEffectä¸­é—­åŒ…çš„é—®é¢˜ã€‚</p> <p>æ¯”å¦‚ç»„ä»¶ç¬¬ä¸€æ¬¡æ¸²æŸ“æ‰§è¡Œ <code>App()</code>ï¼Œæ‰§è¡Œ <code>useState</code> è®¾ç½®äº†åˆå§‹çŠ¶æ€ä¸º1ï¼Œæ‰€ä»¥æ­¤æ—¶çš„ <code>count</code> ä¸º1ã€‚ç„¶åæ‰§è¡Œäº† <code>useEffect</code>ï¼Œå›è°ƒå‡½æ•°æ‰§è¡Œï¼Œè®¾ç½®äº†ä¸€ä¸ªå®šæ—¶å™¨æ¯éš” 1s æ‰“å°ä¸€æ¬¡ <code>count</code>ã€‚</p> <p>æ¥ç€æƒ³è±¡å¦‚æœ <code>click</code> å‡½æ•°è¢«è§¦å‘äº†ï¼Œè°ƒç”¨ <code>setCount(2)</code> è‚¯å®šä¼šè§¦å‘reactçš„æ›´æ–°ï¼Œæ›´æ–°åˆ°å½“å‰ç»„ä»¶çš„æ—¶å€™ä¹Ÿæ˜¯æ‰§è¡Œ <code>App()</code>ï¼Œä¹‹å‰è¯´çš„é“¾è¡¨å·²ç»å½¢æˆäº†å“ˆï¼Œæ­¤æ—¶ <code>useState</code> å°† <code>Hook</code> å¯¹è±¡ ä¸Šä¿å­˜çš„çŠ¶æ€ç½®ä¸º2ï¼Œ é‚£ä¹ˆæ­¤æ—¶ <code>count</code> ä¹Ÿä¸º2äº†ã€‚ç„¶ååœ¨æ‰§è¡Œ <code>useEffect</code> ç”±äºä¾èµ–æ•°ç»„æ˜¯ä¸€ä¸ªç©ºçš„æ•°ç»„ï¼Œæ‰€ä»¥æ­¤æ—¶å›è°ƒå¹¶ä¸ä¼šè¢«æ‰§è¡Œã€‚</p> <p>okï¼Œè¿™æ¬¡æ›´æ–°çš„è¿‡ç¨‹ä¸­æ ¹æœ¬å°±æ²¡æœ‰æ¶‰åŠåˆ°è¿™ä¸ªå®šæ—¶å™¨ï¼Œè¿™ä¸ªå®šæ—¶å™¨è¿˜åœ¨åšæŒçš„ï¼Œé»˜é»˜çš„ï¼Œæ¯éš”1sæ‰“å°ä¸€æ¬¡ <code>count</code>ã€‚ æ³¨æ„è¿™é‡Œæ‰“å°çš„ <code>count</code> ï¼Œæ˜¯ç»„ä»¶ç¬¬ä¸€æ¬¡æ¸²æŸ“çš„æ—¶å€™ <code>App()</code> æ—¶çš„ <code>count</code>ï¼Œ <code>count</code>çš„å€¼ä¸º1ï¼Œ<strong>å› ä¸ºåœ¨å®šæ—¶å™¨çš„å›è°ƒå‡½æ•°é‡Œé¢è¢«å¼•ç”¨äº†ï¼Œå½¢æˆäº†é—­åŒ…ä¸€ç›´è¢«ä¿å­˜</strong></p> <p>æ‰€ä»¥useEffectæˆ–è€…useMemoä¾èµ–æ•°ç»„å­˜åœ¨çš„æ„ä¹‰ï¼Œæ˜¯reactä¸ºäº†åˆ¤å®šï¼Œåœ¨<strong>æœ¬æ¬¡æ›´æ–°</strong>ä¸­ï¼Œæ˜¯å¦éœ€è¦æ‰§è¡Œå…¶ä¸­çš„å›è°ƒå‡½æ•°ï¼Œè¿™é‡Œä¾èµ–äº†çš„num2ï¼Œè€Œnum2æ”¹å˜äº†ã€‚å›è°ƒå‡½æ•°è‡ªç„¶ä¼šæ‰§è¡Œï¼Œ è¿™æ—¶å½¢æˆçš„é—­åŒ…å¼•ç”¨çš„å°±æ˜¯æœ€æ–°çš„num1å’Œnum2ï¼Œæ‰€ä»¥ï¼Œè‡ªç„¶èƒ½å¤Ÿæ‹¿åˆ°æ–°é²œçš„å€¼ã€‚é—®é¢˜çš„å…³é”®ï¼Œåœ¨äºå›è°ƒå‡½æ•°æ‰§è¡Œçš„æ—¶æœºï¼Œé—­åŒ…å°±åƒæ˜¯ä¸€ä¸ªç…§ç›¸æœºï¼ŒæŠŠå›è°ƒå‡½æ•°æ‰§è¡Œçš„é‚£ä¸ªæ—¶æœºçš„é‚£äº›å€¼ä¿å­˜äº†ä¸‹æ¥ã€‚</p> <p>useRefçš„åŸç†</p> <p>åˆå§‹åŒ–çš„ <code>useRef</code> æ‰§è¡Œä¹‹åï¼Œè¿”å›çš„éƒ½æ˜¯åŒä¸€ä¸ªå¯¹è±¡ã€‚</p> <p>ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨ç»„ä»¶æ¯ä¸€æ¬¡æ¸²æŸ“çš„è¿‡ç¨‹ä¸­ã€‚ æ¯”å¦‚ <code>ref = useRef()</code> æ‰€è¿”å›çš„éƒ½æ˜¯åŒä¸€ä¸ªå¯¹è±¡ï¼Œæ¯æ¬¡ç»„ä»¶æ›´æ–°æ‰€ç”Ÿæˆçš„<code>ref</code>æŒ‡å‘çš„éƒ½æ˜¯åŒä¸€ç‰‡å†…å­˜ç©ºé—´ï¼Œ é‚£ä¹ˆå½“ç„¶èƒ½å¤Ÿæ¯æ¬¡éƒ½æ‹¿åˆ°æœ€æ–°é²œçš„å€¼äº†ã€‚</p> <div class="language-react extra-class"><pre class="language-text"><code>    /* å°†è¿™äº›ç›¸å…³çš„å˜é‡å†™åœ¨å‡½æ•°å¤– ä»¥æ¨¡æ‹Ÿreact hookså¯¹åº”çš„å¯¹è±¡ */
	let isC = false
	let isInit = true; // æ¨¡æ‹Ÿç»„ä»¶ç¬¬ä¸€æ¬¡åŠ è½½
	let ref = {
		current: null
	}

	function useEffect(cb){
		// è¿™é‡Œç”¨æ¥æ¨¡æ‹Ÿ useEffect ä¾èµ–ä¸º [] çš„æ—¶å€™åªæ‰§è¡Œä¸€æ¬¡ã€‚
 		if (isC) return
		isC = true	
		cb()	
	}

	function useRef(value){
		// ç»„ä»¶æ˜¯ç¬¬ä¸€æ¬¡åŠ è½½çš„è¯è®¾ç½®å€¼ å¦åˆ™ç›´æ¥è¿”å›å¯¹è±¡
		if ( isInit ) {
			ref.current = value
			isInit = false
		}
		return ref
	}

	function App(){
		let ref_ = useRef(1)
		ref_.current++
		useEffect(()=&gt;{
			setInterval(()=&gt;{
				console.log(ref.current) // 3
			}, 2000)
		})
	}

		// è¿ç»­æ‰§è¡Œä¸¤æ¬¡ ç¬¬ä¸€æ¬¡ç»„ä»¶åŠ è½½ ç¬¬äºŒæ¬¡ç»„ä»¶æ›´æ–°
	App()
	App()
</code></pre></div><p>å¦å¤–çš„è§£å†³æ–¹å¼æ˜¯ï¼Œåªè¦æˆ‘ä»¬èƒ½ä¿è¯æ¯æ¬¡ç»„ä»¶æ›´æ–°çš„æ—¶å€™ï¼Œ<code>useState</code> è¿”å›çš„æ˜¯åŒä¸€ä¸ªå¯¹è±¡çš„è¯ï¼Ÿæˆ‘ä»¬ä¹Ÿèƒ½ç»•å¼€é—­åŒ…é™·é˜±è¿™ä¸ªæƒ…æ™¯</p> <div class="language-react extra-class"><pre class="language-text"><code>function App() {
  // return &lt;Demo1 /&gt;
  return &lt;Demo2 /&gt;
}

function Demo2(){
  const [obj, setObj] = useState({name: 'chechengyi'})

  useEffect(()=&gt;{
    setInterval(()=&gt;{
      console.log(obj)
    }, 2000)
  }, [])
  
  function handClick(){
    setObj((prevState)=&gt; {
      var nowObj = Object.assign(prevState, {
        name: 'baobao',
        age: 24
      })
      console.log(nowObj == prevState)
      return nowObj
    })
  }
  return (
    &lt;div&gt;
      &lt;div&gt;
        &lt;span&gt;name: {obj.name} | age: {obj.age}&lt;/span&gt;
        &lt;div&gt;&lt;button onClick={handClick}&gt;click!&lt;/button&gt;&lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  )
}
</code></pre></div><h4 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="header-anchor">#</a> è§£å†³æ–¹æ¡ˆ</h4> <p><strong>ä½¿ç”¨setstateå›è°ƒ</strong></p> <p>æŠŠsetCount(count+1)æ”¹æˆsetCount(count=&gt;count+1)ï¼Œå‡½æ•°å¼æ›´æ–°</p> <p>å®ƒå…è®¸æˆ‘ä»¬æŒ‡å®šstateå¦‚ä½•æ”¹å˜è€Œä¸å¼•ç”¨å½“å‰çš„stateï¼Œå› ä¸ºå›è°ƒå‡½æ•°ä¸­çš„å‚æ•°æ˜¯æœ€æ–°çš„countå€¼</p> <p><strong>ä½¿ç”¨useReducerä»£æ›¿</strong></p> <p>æŠŠsetCountæ”¹æˆuseReducerçš„dispatchï¼Œå› ä¸ºuseReducerçš„dispatchçš„èº«ä»½æ°¸è¿œæ˜¯ç¨³å®šçš„ã€‚å³ä½¿reducerå‡½æ•°æ˜¯å®šä¹‰åœ¨å‡½æ•°å†…éƒ¨ä¸”ä¾èµ–props</p> <div class="language-react extra-class"><pre class="language-text"><code>const setCountReducer = (state,action)=&gt;{
   switch(action.type){
     case 'add':
       return state+action.value 
     case 'minus':
       return state-action.value
     default: 
       return state
   }
}

const App = () =&gt;{
  const [count,dispatch] = useReducer(setCountReducer,0)
  useEffect(()=&gt;{
    const timeId = setInterval(()=&gt;{
      dispatch({type:'add',value:1})
    },1000)
    return ()=&gt; clearInterval(timeId)
  },[])
  return (
     &lt;span&gt;{count}&lt;/span&gt;
  )
} 
</code></pre></div><p><strong>ä½¿ç”¨useRefå­˜å‚¨å˜é‡</strong></p> <p>é€šè¿‡useRefç”Ÿæˆçš„å¯¹è±¡é»˜è®¤éƒ½æ˜¯{current:{}},æ¯æ¬¡ç»„ä»¶é‡æ–°æ¸²æŸ“æ—¶ï¼Œä»–ä¹Ÿæ˜¯åŒä¸€ä¸ªå¯¹è±¡çš„å¼•ç”¨ï¼Œä¸ä¼šå› ä¸ºç»„ä»¶çš„é‡æ–°æ¸²æŸ“å¯¼è‡´å–å¾—é—­åŒ…çš„å¯¹è±¡å¼•ç”¨ï¼Œå› æ­¤å®ƒä¸ä»…å¯ä»¥ç»‘å®šDOMï¼Œä¹Ÿå¯ä»¥ç»‘å®šä»»æ„æˆ‘ä»¬æƒ³ç»‘å®šçš„æ•°æ®</p> <p>æ”¹é€ ä»£ç å¦‚ä¸‹</p> <div class="language-react extra-class"><pre class="language-text"><code>const App = () =&gt;{
  const [count,setCount] = useState(0)
  const countRef = useRef()
  countRef.current = count
  useEffect(()=&gt;{
    const timeId = setInterval(()=&gt;{
      setCount(countRef.current+1)
    },1000)
    return ()=&gt; clearInterval(timeId)
  },[])
  return (
     &lt;span&gt;{countRef.current}&lt;/span&gt;
  )
}
</code></pre></div><h4 id="å…¶ä»–ä¼šå¯¼è‡´é—­åŒ…é™·é˜±çš„æƒ…å†µ"><a href="#å…¶ä»–ä¼šå¯¼è‡´é—­åŒ…é™·é˜±çš„æƒ…å†µ" class="header-anchor">#</a> å…¶ä»–ä¼šå¯¼è‡´é—­åŒ…é™·é˜±çš„æƒ…å†µ</h4> <p>å¼‚æ­¥å‡½æ•°</p> <p>ä½¿ç”¨setIntervalå’ŒsetTimeoutå‡½æ•°æ—¶ï¼Œå†…éƒ¨çš„å˜é‡è¯»å–çš„æ˜¯å¼‚æ­¥å‡½æ•°åœ¨è¿è¡Œæ—¶ç»„ä»¶å¤„åœ¨é—­åŒ…æƒ…å†µä¸‹çš„å½“å‰å€¼ï¼Œå› ä¸ºåœ¨å¼‚æ­¥å‡½æ•°å†…éƒ¨çš„æ•°æ®å¹¶ä¸ä¼šåœ¨domæ›´æ–°ä¹‹åæ›´æ–°ä¸ºæ–°çš„å€¼ï¼Œä»–ä»¬çš„å˜é‡å¼•ç”¨å·²ç»ä¸æ˜¯åŒä¸€ä¸ªäº†</p> <p>ä¸Šä»£ç </p> <div class="language-react extra-class"><pre class="language-text"><code>const App = ()=&gt;{
  const [count,setCount] = useState(0)
  const consoleCount = ()=&gt;{
    const timeId = setTimeout(()=&gt;{
       console.log(count)
    },2000)
    return ()=&gt; clearTimeout(timeId)
  }
  return (
    &lt;div&gt;
      &lt;span&gt;{count}&lt;/span&gt;
      &lt;button onClick={()=&gt;setCount(count+1)}&gt;æŒ‰æˆ‘åŠ 1&lt;/button&gt;
      &lt;button onClick={consoleCount}&gt;è¾“å‡ºcount&lt;/button&gt;
    &lt;/div&gt;
  )
}
</code></pre></div><p>å…ˆç‚¹å‡»ä¸‰æ¬¡åŠ 1æŒ‰é’®ï¼ŒæŠŠcountå˜æˆ3ï¼Œç„¶åç‚¹å‡»è¾“å‡ºæŒ‰é’®ï¼Œæ­¤æ—¶å†ç‚¹å‡»åŠ 1æŒ‰é’®ï¼Œå¯ä»¥çœ‹åˆ°è¾“å‡ºçš„countè¿˜æ˜¯3ï¼Œå³è¾“å‡ºçš„countæ˜¯æ—§å€¼</p> <p>domç›‘å¬å‡½æ•°äº‹ä»¶ä¸­çš„åŒ¿åå‡½æ•°</p> <div class="language-react extra-class"><pre class="language-text"><code>const App = () =&gt;{
    const [count,setCount] = useState(0)
    const consoleCount = ()=&gt;{
      console.log(count)
    }
    useEffect(()=&gt;{
      window.addEventListener('scroll',consoleCount)
      return ()=&gt;{
         window.removeEventListener('scroll',consoleCount)
      }
    },[])
  
    return (
       &lt;div style={{height:'400vh'}}&gt;
         &lt;span&gt;{count}&lt;/span&gt;
        &lt;button onClick={()=&gt;setCount(count+1)}&gt;æŒ‰æˆ‘åŠ 1&lt;/button&gt;
      &lt;button onClick={consoleCount}&gt;è¾“å‡ºcount&lt;/button&gt;
      &lt;/div&gt;
    )
}
</code></pre></div><p>å¯ä»¥çœ‹åˆ°ä¸ç®¡é¡µé¢æ€ä¹ˆæ»šåŠ¨ï¼Œè¾“å‡ºçš„countæ°¸è¿œæ˜¯0ã€‚å› ä¸ºaddEventListeneråªåœ¨useEffectåˆå§‹åŒ–çš„æ—¶å€™è¿›è¡Œäº†ç»‘å®šï¼Œæ‰§è¡Œå‡½æ•°çš„æ—¶å€™ï¼Œcountè¯»å–çš„æ˜¯ç»‘å®šå‡½æ•°æ—¶çš„æ—§å€¼</p> <p>ä½¿ç”¨useRef()å­˜å‚¨å®ä¾‹å˜é‡ä¹Ÿèƒ½è§£å†³è¿™ä¸¤ä¸ªé—®é¢˜ï¼Œä¹Ÿæ˜¯reactå®˜æ–¹æ¨èçš„æ–¹æ³•ã€‚</p> <p>æ¯”å¦‚ä¸Šé¢çš„countï¼Œæˆ‘ä»¬å¯ä»¥æ·»åŠ userefä¸stateè¿›è¡Œå¯¹æ¯”</p> <div class="language-react extra-class"><pre class="language-text"><code>import React, { useState, useRef, useEffect } from &quot;react&quot;;

export default function App() {

  const [count, setCount] = useState(0);
  const latestCount = useRef(count);

  useEffect(() =&gt; {
    latestCount.current = count;
  });

  function handleAlertclick() {
    setTimeout(() =&gt; {
      alert(&quot;latestCount.current:&quot; + latestCount.current + '.. count: ' + count);
    }, 2000);
  }
  
  return (
    &lt;div&gt;
      &lt;p&gt;å½“å‰countï¼š {count} &lt;/p&gt;
      &lt;button onClick={() =&gt; setCount(count + 1)}&gt;count + 1&lt;/button&gt;
      &lt;button onClick={handleAlertclick}&gt; æç¤º &lt;/button&gt;
    &lt;/div&gt;
  )
}
</code></pre></div><h3 id="ä½¿ç”¨react-hookså¦‚ä½•è®©ä¸‹é¢çš„å­ç»„ä»¶åªrenderä¸€æ¬¡"><a href="#ä½¿ç”¨react-hookså¦‚ä½•è®©ä¸‹é¢çš„å­ç»„ä»¶åªrenderä¸€æ¬¡" class="header-anchor">#</a> ä½¿ç”¨react hookså¦‚ä½•è®©ä¸‹é¢çš„å­ç»„ä»¶åªrenderä¸€æ¬¡</h3> <p>ä½¿ç”¨useRefä¿å­˜å­ç»„ä»¶çŠ¶æ€ï¼Œå½“çˆ¶ç»„ä»¶æ›´æ–°æ—¶ï¼Œç›´æ¥æ›´æ–°refå€¼ï¼Œå½“å­ç»„ä»¶clickæ—¶ï¼Œåœ¨æ›´æ–°refå€¼åï¼Œå†è°ƒç”¨ä¸€æ¬¡updateè§¦å‘å­ç»„ä»¶æ¸²æŸ“</p> <div class="language-react extra-class"><pre class="language-text"><code>import React,{useEffect,useMemo,useState,useRef} from 'react'
function A(){
   const [count,setCount] = useState(0);
   
   return (
      &lt;div&gt;
        &lt;p&gt;æˆ‘æ˜¯çˆ¶ç»„ä»¶&lt;/p&gt;
        &lt;p&gt;çˆ¶ç»„ä»¶çš„countæ˜¯{count}&lt;/p&gt;
        &lt;button&gt;click&lt;/button&gt;
        &lt;B count={count}/&gt;
      &lt;/div&gt;
   );
}

const B = React.memo(({count:}{count:number})=&gt;{
  const numberRef = useRef(0);
  const [,update] = useState({});
  const updateNumber = () =&gt;{
    numberRef.current++;
    update({});
  };
  
  useMemo(()=&gt;{
    numberRef.current = count;
  },[count])
  
  console.log('å­ç»„ä»¶Render')
  
  return(
     &lt;div&gt;
       &lt;p&gt;æˆ‘æ˜¯å­ç»„ä»¶&lt;/p&gt;
       &lt;p&gt;å­ç»„ä»¶çš„numberæ˜¯{numberRef.current}&lt;/p&gt;
       &lt;button onClick={updateNumber}&gt;click&lt;/button&gt;
     &lt;/div&gt;
  )
})
</code></pre></div><h3 id="hookä¸æ™®é€šå‡½æ•°çš„åŒºåˆ«"><a href="#hookä¸æ™®é€šå‡½æ•°çš„åŒºåˆ«" class="header-anchor">#</a> Hookä¸æ™®é€šå‡½æ•°çš„åŒºåˆ«</h3> <p>Hookæœ¬èº«æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒä¸æ™®é€šå‡½æ•°æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢</p> <p>1ã€‚è°ƒç”¨æ—¶æœºå’Œè°ƒç”¨æ–¹æ³•ä¸åŒ</p> <p>åœ¨FCä¸­ä½¿ç”¨æ—¶ï¼Œè‡ªå®šä¹‰hookå’Œcommon functionéƒ½é€šè¿‡importä½œä¸ºFCçš„ä¸€éƒ¨åˆ†ï¼Œä½†æ˜¯è°ƒç”¨çš„æ—¶æœºä¸åŒï¼Œhookæ˜¯åœ¨æ¯æ¬¡æ¸²æŸ“çš„æ—¶å€™éƒ½ä¼šè°ƒç”¨ï¼Œè€Œé€šç”¨å‡½æ•°åˆ™éœ€è¦æ‰‹åŠ¨è°ƒç”¨</p> <p>2.å‘½åæ–¹å¼ä¸åŒ</p> <p>hookä¸€èˆ¬ä½¿ç”¨useXXXå‘½åï¼ŒCFå°±ä¼šæ¯”è¾ƒçµæ´»</p> <p>3.èƒ½ä½¿ç”¨çš„å·¥å…·ä¸åŒ</p> <p>è‡ªå®šä¹‰hookä¸­ä¸€èˆ¬ä¼šè°ƒç”¨å…¶ä»–hookï¼Œæ¯”å¦‚useeffectã€useStateï¼Œä½†æ˜¯æ™®é€šå‡½æ•°åªèƒ½å¤„ç†æ²¡æœ‰hookçš„é€»è¾‘</p> <p>4.ä½¿ç”¨åœºæ™¯ä¸åŒ</p> <p>CFå¯ä»¥è¢«ä½¿ç”¨åœ¨ä»»ä½•åœ°æ–¹ï¼Œä½†hookåªèƒ½è¢«ç”¨åœ¨FCæˆ–å…¶ä»–hookä¸­</p> <h3 id="æ›´æ–°æ¬¡æ•°"><a href="#æ›´æ–°æ¬¡æ•°" class="header-anchor">#</a> æ›´æ–°æ¬¡æ•°</h3> <div class="language-react extra-class"><pre class="language-text"><code>function setStateProps () {
  const [count, setCount] = useState(-1);
  
  useEffect(()=&gt; {
    setCount(1)
  })
  
  console.log('render') 
  
  return (
 		&lt;div&gt;
    	&lt;h3&gt;page&lt;/h3&gt;
      &lt;p&gt;{count}&lt;/p&gt;
    &lt;/div&gt;
  )
}
</code></pre></div><p>ä¸Šé¢çš„ä»£ç ä¼šlogä¸‰æ¬¡ï¼Œä¸€æ¬¡åœ¨åˆå§‹åŒ–ï¼Œä¸€æ¬¡åœ¨setStateï¼Œè¿˜æœ‰ä¸€æ¬¡æ˜¯æ¯”è¾ƒpropsï¼Œç›¸åŒåˆ™ä¸å†æ‰§è¡Œ</p> <h2 id="hookå†™æ³•"><a href="#hookå†™æ³•" class="header-anchor">#</a> Hookå†™æ³•</h2> <h3 id="hookè°ƒç”¨å¼‚æ­¥æ¥å£å†™æ³•"><a href="#hookè°ƒç”¨å¼‚æ­¥æ¥å£å†™æ³•" class="header-anchor">#</a> Hookè°ƒç”¨å¼‚æ­¥æ¥å£å†™æ³•</h3> <div class="language-react extra-class"><pre class="language-text"><code>import React, { useState, useEffect } from 'react'
import axios from 'axios'

function App() {
  const [data, setData] = useState({ products: [{
    productId: '123',
    productName: 'macbook'
  }] });
  const [isLoading, setIsLoading] = useState(false);
  const [isError,setIsError] = useState(false);
  
  useEffect(()=&gt; {
    const fetchData = async()=&gt; {
      setIsError(false);
      setIsLoading(true);
      
      try {
        const result = await axios (
        	'https://c.com/api/products?date=today',
        )
        setData(result.data);
      }catch(e){
        setIsError(true);
      }
      
      setIsLoading(false);
    }
    fetchData();
  },[]);
  
  return (
  	&lt;div&gt;
      { isError &amp;&amp; &lt;div&gt;&lt;/div&gt;}
      { isLoading ? (
      	&lt;div&gt;Loading...&lt;/div&gt;
      ):(
      	&lt;ul&gt;
        	{data.products.map(i=&gt; (
          	&lt;li key=&quot;{i.productId}&quot;&gt;
              {i.productName}
            &lt;/li&gt;
          ))}
        &lt;/ul&gt;
      )};
    &lt;/div&gt;
  )
}

export default App;
</code></pre></div><p>ä¹Ÿå¯ä»¥ä½¿ç”¨ç«‹å³æ‰§è¡Œå‡½æ•°</p> <div class="language-react extra-class"><pre class="language-text"><code>const MyFunctionnalComponent: React.FC = props =&gt; {
  useEffect(()=&gt;{
    (async function anyNameFunction() {
      await loadContent();
    })();
  },[]);
  return &lt;div&gt;&lt;/div&gt;
}
</code></pre></div><h3 id="hook-tså†™æ³•"><a href="#hook-tså†™æ³•" class="header-anchor">#</a> hook tså†™æ³•</h3> <p>usestateå¦‚æœåˆå§‹å€¼ä¸æ˜¯null/undefinedï¼Œæ˜¯å…·å¤‡ç±»å‹æ¨å¯¼èƒ½åŠ›çš„ã€‚æ ¹æ®ä¼ å…¥çš„åˆå§‹å€¼æ¨æ–­å‡ºç±»å‹ã€‚åˆå§‹å€¼å¦‚æœæ˜¯null/undefinedåˆ™éœ€è¦ä¼ é€’ç±»å‹å®šä¹‰æ‰èƒ½è¿›è¡Œçº¦æŸã€‚ä¸€èˆ¬æƒ…å†µä¸‹è¿˜æ˜¯æ¨èä¼ å…¥ç±»å‹</p> <div class="language-react extra-class"><pre class="language-text"><code>const [value, setValue] = useState(0)

const [value, setValue] = useState&lt;number&gt;(0)

const [string, setString] = useState&lt;string&gt;('')

const [array, setArray] = useState&lt;any[]&gt;([])
</code></pre></div><p>useContextä¸€èˆ¬æ ¹æ®ä¼ å…¥çš„contextå€¼å°±å¯ä»¥æ¨æ–­å‡ºè¿”å›ç±»å‹ï¼Œä¸éœ€è¦ä¼ é€’ç±»å‹</p> <p>useEffectå’ŒuseLayoutEffectæ— è¿”å›å€¼ï¼Œæ— éœ€ä¼ é€’ç±»å‹</p> <p>useMemoæ— éœ€ä¼ é€’ç±»å‹ï¼Œæ ¹æ®å‡½æ•°çš„è¿”å›å€¼å¯ä»¥åˆ¤æ–­ç±»å‹</p> <p>useCallbackæ— éœ€ä¼ é€’ç±»å‹ï¼Œæ ¹æ®å‡½æ•°çš„è¿”å›å€¼å¯ä»¥æ¨æ–­ç±»å‹ï¼Œä½†æ˜¯æ³¨æ„å‡½æ•°çš„å…¥å‚éœ€è¦å®šä¹‰ç±»å‹ï¼Œä¸ç„¶å°±æ˜¯æ¨æ–­ä¸ºany</p> <p>useReféœ€è¦çº¦æŸref.currentçš„ç±»å‹</p> <p>useReduceréœ€è¦å¯¹reducerå‡½æ•°çš„å…¥å‚stateå’Œactionè¿›è¡Œç±»å‹çº¦æŸæ¨æ–­ç±»å‹</p> <h3 id="hookså®ç°è¯·æ±‚çŠ¶æ€"><a href="#hookså®ç°è¯·æ±‚çŠ¶æ€" class="header-anchor">#</a> hookså®ç°è¯·æ±‚çŠ¶æ€</h3> <p>useState</p> <div class="language-react extra-class"><pre class="language-text"><code>import React, { useState, useEffect } from 'react'
import axios from 'axios'

interface postType {
  userId: number
  id: number
  title: string
  body: string
}

function DataFetchingOne() {
  const [loading, setLoading] = useState(true)
  const [error, setError] = useState('')
  const [post, setPost] = useState({} as postType)

  useEffect(() =&gt; {
    axios.get('https://jsonplaceholder.typicode.com/posts/1').then((res) =&gt; {
      setLoading(false)
      setPost(res.data)
      setError('')
    }).catch(() =&gt; {
      setLoading(false)
      setPost({} as postType)
      setError('something went wrong')
    })
  }, [])

  return (
    &lt;div&gt;
      {
        loading
          ? 'Loading...'
          : post.title
      }
      {
        error
          ? error
          : null
      }
    &lt;/div&gt;
  )
}

export default DataFetchingOne
</code></pre></div><p>useReducer</p> <div class="language-react extra-class"><pre class="language-text"><code>import React, { useEffect, useReducer } from 'react'
import axios from 'axios'

interface postType {
  userId: number
  id: number
  title: string
  body: string
}

type stateType = {
  loading: boolean
  error: string
  post?: postType | {}
}

type actionType = {
  type: 'FETCH_SUCCESS' | 'FETCH_ERROR'
  payload?: postType | {}
}

const initialState = {
  loading: true,
  error: '',
  post: {},
}

const reducer = (state: stateType, action: actionType) =&gt; {
  switch (action.type) {
    case 'FETCH_SUCCESS':
      return {
        loading: false,
        error: '',
        post: action.payload,
      }
    case 'FETCH_ERROR':
      return {
        loading: false,
        error: 'something went wrong',
        post: {},
      }
    default:
      return state
  }
}

function DataFetchingTwo() {
  const [state, dispatch] = useReducer(reducer, initialState)

  useEffect(() =&gt; {
    axios.get('https://jsonplaceholder.typicode.com/posts/1').then((res) =&gt; {
      dispatch({
        type: 'FETCH_SUCCESS',
        payload: res.data,
      })
    }).catch(() =&gt; {
      dispatch({
        type: 'FETCH_ERROR'
      })
    })
  }, [])

  return (
    &lt;div&gt;
      {
        state.loading
          ? 'Loading...'
          // @ts-ignore
          : state.post.title
      }
      {
        state.error
          ? state.error
          : null
      }
    &lt;/div&gt;
  )
}

export default DataFetchingTwo
</code></pre></div><h3 id="ä½¿ç”¨react-hooké‡å†™react-redux"><a href="#ä½¿ç”¨react-hooké‡å†™react-redux" class="header-anchor">#</a> ä½¿ç”¨react-hooké‡å†™react-redux</h3> <p>react-reduxä¸»è¦æä¾›çš„åŠŸèƒ½æ˜¯å°†reduxå’Œreacté“¾æ¥èµ·æ¥ã€‚ ä½¿ç”¨æä¾›çš„connectæ–¹æ³•å¯ä»¥ä½¿å¾—ä»»æ„ä¸€ä¸ªreactç»„ä»¶è·å–åˆ°å…¨å±€çš„storeä¸Šçš„çŠ¶æ€ã€‚ å®ç°æ–¹æ³•æ˜¯å°†storeå­˜æ”¾äºç”±provideræä¾›çš„contextä¸Šï¼Œåœ¨è°ƒç”¨connectæ—¶ï¼Œ å°±å¯å°†ç»„ä»¶çš„propsæ›¿æ¢ï¼Œ è®©å…¶å¯ä»¥è®¿é—®åˆ°å®šåˆ¶åŒ–çš„æ•°æ®æˆ–è€…æ–¹æ³•</p> <p>é‡å†™è¦å®ç°ï¼š</p> <ul><li>å…¨å±€ç»´æŠ¤ä¸€ä¸ªstoreã€‚</li> <li>ä»»ä½•ç»„ä»¶éƒ½å¯ä»¥è·å–åˆ°storeï¼Œæœ€å¥½propså¯ä»¥å®šåˆ¶ï¼ˆmapStatetoPropsï¼‰ã€‚</li> <li>æä¾›å¯ä»¥æ´¾å‘actionçš„èƒ½åŠ›ï¼ˆmapDispatchtoPropsï¼‰</li></ul> <p>å…ˆä½¿ç”¨useContextåˆ›å»ºä¸€ä¸ªä¸Šä¸‹æ–‡</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> createContext<span class="token punctuation">,</span> useContext <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> context <span class="token operator">=</span> <span class="token function">createContext</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> StoreProvider <span class="token operator">=</span> context<span class="token punctuation">.</span>provider<span class="token punctuation">;</span>

<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">useContext</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span>
</code></pre></div><p>åˆ›å»ºä¸€ä¸ªdispatchåˆ†å‘çŠ¶æ€</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">useDispatch</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">useContext</span><span class="token punctuation">(</span>Context<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> store<span class="token punctuation">.</span>dispatch
<span class="token punctuation">}</span>
</code></pre></div><p>ç„¶åä½¿ç”¨useStoreStateæ‹¿åˆ°çŠ¶æ€</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">useStoreState</span> <span class="token punctuation">(</span><span class="token parameter">mapState</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">useContext</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
		<span class="token keyword">const</span> <span class="token function-variable function">mapStateFn</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">mapState</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">const</span> <span class="token punctuation">[</span>mappedState<span class="token punctuation">,</span> setMappedState<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">mapStateFn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  
		<span class="token comment">// If the store or mapState change, rerun mapState    </span>
		<span class="token keyword">const</span> <span class="token punctuation">[</span>prevStore<span class="token punctuation">,</span> setPrevStore<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span>store<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">const</span> <span class="token punctuation">[</span>prevMapState<span class="token punctuation">,</span> setPrevMapState<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> mapState<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>prevStore <span class="token operator">!==</span> store <span class="token operator">||</span> prevMapState <span class="token operator">!==</span> mapState<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">setPrevStore</span><span class="token punctuation">(</span>store<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">setPrevMapState</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> mapState<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">setMappedState</span><span class="token punctuation">(</span><span class="token function">mapStateFn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    
    <span class="token punctuation">}</span>

		<span class="token keyword">const</span> lastRenderedMappedState <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Set the last mapped state after rendering.</span>
    <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
       lastRenderedMappedState<span class="token punctuation">.</span>current <span class="token operator">=</span> mappedState<span class="token punctuation">;</span>    
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
     <span class="token punctuation">{</span>
       <span class="token comment">// Run the mapState callback and if the result has changed, make the      </span>
       <span class="token comment">// component re-render with the new state.         </span>
      <span class="token keyword">const</span> <span class="token function-variable function">checkForUpdates</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>  
        <span class="token keyword">const</span> newMappedState <span class="token operator">=</span> <span class="token function">mapStateFn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">shallowEqual</span><span class="token punctuation">(</span>newMappedState<span class="token punctuation">,</span> lastRenderedMappedState<span class="token punctuation">.</span>current<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token function">setMappedState</span><span class="token punctuation">(</span>newMappedState<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>

       <span class="token comment">// Pull data from the store on first render.</span>

       <span class="token function">checkForUpdates</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        
       <span class="token comment">// Subscribe to the store to be notified of subsequent changes.</span>

       <span class="token keyword">const</span> unsubscribe <span class="token operator">=</span> store<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>checkForUpdates<span class="token punctuation">)</span><span class="token punctuation">;</span>

       <span class="token comment">// The return value of useEffect will be called when unmounting, so           </span>
       <span class="token comment">// we use it to unsubscribe from the store.</span>

       <span class="token keyword">return</span> unsubscribe<span class="token punctuation">;</span>
    	<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">[</span>store<span class="token punctuation">,</span> mapState<span class="token punctuation">]</span><span class="token punctuation">,</span>    
		<span class="token punctuation">)</span><span class="token punctuation">;</span>  
	<span class="token keyword">return</span> mappedState
<span class="token punctuation">}</span>
</code></pre></div><p>å½“storeå˜åŒ–è¿‡åï¼Œå¹¶æ²¡æœ‰å’Œè§†å›¾å…³è”èµ·æ¥ã€‚å¦ä¸€ä¸ªé—®é¢˜æ˜¯æ²¡æœ‰å…³æ³¨mapStateå˜åŒ–çš„æƒ…å†µã€‚ æˆ‘ä»¬å¯ä»¥åˆ©ç”¨useEffectè¿™ä¸ªå†…ç½®hookï¼Œåœ¨ç»„ä»¶mountæ—¶å®Œæˆåœ¨storeä¸Šçš„è®¢é˜…ï¼Œå¹¶åœ¨unmontçš„æ—¶å€™å–æ¶ˆè®¢é˜…ã€‚ mapStateçš„å˜æ›´å¯ä»¥ä½¿ç”¨useStateæ¥ç›‘å¬ï¼Œ æ¯æ¬¡æœ‰å˜æ›´æ—¶å°±æ‰§è¡Œå‘å¯¹åº”çš„setteræ–¹æ³•</p> <h2 id="hookåŒ…"><a href="#hookåŒ…" class="header-anchor">#</a> HookåŒ…</h2> <h3 id="ahooks"><a href="#ahooks" class="header-anchor">#</a> ahooks</h3> <p>å®‰è£…</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">npm</span> <span class="token function">install</span> <span class="token parameter variable">--save</span> ahooks
</code></pre></div><p>ahooks é»˜è®¤æ”¯æŒåŸºäº ES module çš„ tree shakingï¼Œå¯¹äº js éƒ¨åˆ†ï¼Œç›´æ¥å¼•å…¥ <code>import { useToggle } from 'ahooks'</code> ä¹Ÿä¼šæœ‰æŒ‰éœ€åŠ è½½çš„æ•ˆæœã€‚</p> <p>å¸¸ç”¨hook</p> <h4 id="å¢å¼ºç‰ˆstate"><a href="#å¢å¼ºç‰ˆstate" class="header-anchor">#</a> å¢å¼ºç‰ˆstate</h4> <p><code>useRequest</code> æ˜¯ä¸€ä¸ªå¼ºå¤§çš„å¼‚æ­¥æ•°æ®ç®¡ç†çš„ Hooksï¼ŒReact é¡¹ç›®ä¸­çš„ç½‘ç»œè¯·æ±‚åœºæ™¯ä½¿ç”¨ <code>useRequest</code> å°±å¤Ÿäº†ã€‚</p> <div class="language-react extra-class"><pre class="language-text"><code>const { data, error, loading } = useRequest(getUsername, {
  manaul: true;
});
</code></pre></div><p><code>useRequest</code> æä¾›äº†ä»¥ä¸‹å‡ ä¸ªç”Ÿå‘½å‘¨æœŸé…ç½®é¡¹ï¼Œä¾›ä½ åœ¨å¼‚æ­¥å‡½æ•°çš„ä¸åŒé˜¶æ®µåšä¸€äº›å¤„ç†ã€‚</p> <ul><li><code>onBefore</code>ï¼šè¯·æ±‚ä¹‹å‰è§¦å‘</li> <li><code>onSuccess</code>ï¼šè¯·æ±‚æˆåŠŸè§¦å‘</li> <li><code>onError</code>ï¼šè¯·æ±‚å¤±è´¥è§¦å‘</li> <li><code>onFinally</code>ï¼šè¯·æ±‚å®Œæˆè§¦å‘</li></ul> <p>é€šè¿‡è®¾ç½® <code>options.pollingInterval</code>ï¼Œè¿›å…¥è½®è¯¢æ¨¡å¼ï¼Œ<code>useRequest</code> ä¼šå®šæ—¶è§¦å‘ service æ‰§è¡Œã€‚</p> <p>é€šè¿‡è®¾ç½® <code>options.debounceWait</code>ï¼Œè¿›å…¥é˜²æŠ–æ¨¡å¼ï¼Œæ­¤æ—¶å¦‚æœé¢‘ç¹è§¦å‘ <code>run</code> æˆ–è€… <code>runAsync</code>ï¼Œåˆ™ä¼šä»¥é˜²æŠ–ç­–ç•¥è¿›è¡Œè¯·æ±‚ã€‚</p> <p>é€šè¿‡è®¾ç½® <code>options.throttleWait</code>ï¼Œè¿›å…¥èŠ‚æµæ¨¡å¼ï¼Œæ­¤æ—¶å¦‚æœé¢‘ç¹è§¦å‘ <code>run</code> æˆ–è€… <code>runAsync</code>ï¼Œåˆ™ä¼šä»¥èŠ‚æµç­–ç•¥è¿›è¡Œè¯·æ±‚ã€‚</p> <p>å¦‚æœè®¾ç½®äº† <code>options.cacheKey</code>ï¼Œ<code>useRequest</code> ä¼šå°†å½“å‰è¯·æ±‚æˆåŠŸçš„æ•°æ®ç¼“å­˜èµ·æ¥ã€‚ä¸‹æ¬¡ç»„ä»¶åˆå§‹åŒ–æ—¶ï¼Œå¦‚æœæœ‰ç¼“å­˜æ•°æ®ï¼Œæˆ‘ä»¬ä¼šä¼˜å…ˆè¿”å›ç¼“å­˜æ•°æ®ï¼Œç„¶ååœ¨èƒŒåå‘é€æ–°è¯·æ±‚ï¼Œä¹Ÿå°±æ˜¯ SWR çš„èƒ½åŠ›ã€‚</p> <p>ä½ å¯ä»¥é€šè¿‡ <code>options.staleTime</code> è®¾ç½®æ•°æ®ä¿æŒæ–°é²œæ—¶é—´ï¼Œåœ¨è¯¥æ—¶é—´å†…ï¼Œæˆ‘ä»¬è®¤ä¸ºæ•°æ®æ˜¯æ–°é²œçš„ï¼Œä¸ä¼šé‡æ–°å‘èµ·è¯·æ±‚ã€‚</p> <p>ä½ ä¹Ÿå¯ä»¥é€šè¿‡ <code>options.cacheTime</code> è®¾ç½®æ•°æ®ç¼“å­˜æ—¶é—´ï¼Œè¶…è¿‡è¯¥æ—¶é—´ï¼Œæˆ‘ä»¬ä¼šæ¸…ç©ºè¯¥æ¡ç¼“å­˜æ•°æ®ã€‚</p> <p>é€šè¿‡è®¾ç½® <code>options.retryCount</code>ï¼ŒæŒ‡å®šé”™è¯¯é‡è¯•æ¬¡æ•°ï¼Œåˆ™ useRequest åœ¨å¤±è´¥åä¼šè¿›è¡Œé‡è¯•ã€‚</p> <p>useTitle</p> <p>æ”¹å˜é¡µé¢åœ¨tabé¡µä¸­çš„æ ‡é¢˜</p> <div class="language-react extra-class"><pre class="language-text"><code>import React, { useState } from &quot;react&quot;;
import { useTitle } from &quot;react-use&quot;;

const Demo = () =&gt; {
  useTitle(&quot;Hello world!&quot;, {
    restoreOnUnmount: true,
  });

  return &lt;h1&gt;document.title has changed&lt;/h1&gt;;
};

export default () =&gt; {
  const [showDemo, setShowDemo] = useState(true);

  return (
    &lt;div&gt;
      &lt;button onClick={() =&gt; setShowDemo(!showDemo)}&gt;
        {showDemo ? &quot;unmount&quot; : &quot;mount&quot;}
      &lt;/button&gt;
      {showDemo ? &lt;Demo /&gt; : &quot;&quot;}
    &lt;/div&gt;
  );
};
</code></pre></div><p>æºç </p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token comment">// src/useTitle.ts</span>

<span class="token comment">/* eslint-disable */</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> useRef<span class="token punctuation">,</span> useEffect <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">UseTitleOptions</span> <span class="token punctuation">{</span>
  restoreOnUnmount<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> <span class="token constant">DEFAULT_USE_TITLE_OPTIONS</span><span class="token operator">:</span> UseTitleOptions <span class="token operator">=</span> <span class="token punctuation">{</span>
  restoreOnUnmount<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">useTitle</span><span class="token punctuation">(</span>
  title<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
  options<span class="token operator">:</span> UseTitleOptions <span class="token operator">=</span> <span class="token constant">DEFAULT_USE_TITLE_OPTIONS</span>
<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> prevTitleRef <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span>title<span class="token punctuation">)</span><span class="token punctuation">;</span>
  document<span class="token punctuation">.</span>title <span class="token operator">=</span> title<span class="token punctuation">;</span>
  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>options <span class="token operator">&amp;&amp;</span> options<span class="token punctuation">.</span>restoreOnUnmount<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        document<span class="token punctuation">.</span>title <span class="token operator">=</span> prevTitleRef<span class="token punctuation">.</span>current<span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">typeof</span> document <span class="token operator">!==</span> <span class="token string">&quot;undefined&quot;</span>
  <span class="token operator">?</span> <span class="token function-variable function">useTitle</span>
  <span class="token operator">:</span> <span class="token punctuation">(</span>_title<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>useBoolean</p> <p>useToggle</p> <p>ç”¨äºåœ¨ä¸¤ä¸ªçŠ¶æ€å€¼é—´åˆ‡æ¢çš„ Hookã€‚</p> <p>useUrlState</p> <p>é€šè¿‡ url query æ¥ç®¡ç† state çš„ Hookã€‚</p> <p>è¯¥ Hooks åŸºäº <code>react-router</code> çš„ useLocation &amp; useHistory &amp; useNavigate è¿›è¡Œ query ç®¡ç†ï¼Œæ‰€ä»¥ä½¿ç”¨è¯¥ Hooks ä¹‹å‰ï¼Œä½ éœ€è¦ä¿è¯</p> <ol><li><p>ä½ é¡¹ç›®æ­£åœ¨ä½¿ç”¨ <code>react-router</code> 5.x æˆ– 6.x ç‰ˆæœ¬æ¥ç®¡ç†è·¯ç”±</p></li> <li><p>ç‹¬ç«‹å®‰è£…äº† @ahooksjs/use-url-state</p></li></ol> <p>è¯¥hookså¯ä»¥æ”¹å˜å½“å‰urlä¸­çš„query</p> <h4 id="å­˜å‚¨ç›¸å…³çš„hooks"><a href="#å­˜å‚¨ç›¸å…³çš„hooks" class="header-anchor">#</a> å­˜å‚¨ç›¸å…³çš„hooks</h4> <p>useCookieState</p> <p>å°†çŠ¶æ€å­˜å‚¨åœ¨ Cookie ä¸­çš„ Hook ã€‚</p> <p>useLocalStorageState</p> <p>å°†çŠ¶æ€å­˜å‚¨åœ¨ localStorage ä¸­çš„ Hook ã€‚</p> <p>useSessionStorageState</p> <p>å°†çŠ¶æ€å­˜å‚¨åœ¨ sessionStorageä¸­çš„ Hook ã€‚</p> <h4 id="æ€§èƒ½ä¼˜åŒ–hooks"><a href="#æ€§èƒ½ä¼˜åŒ–hooks" class="header-anchor">#</a> æ€§èƒ½ä¼˜åŒ–hooks</h4> <p><code>useCreation</code> æ˜¯ <code>useMemo</code> æˆ– <code>useRef</code> çš„æ›¿ä»£å“ã€‚</p> <p>å› ä¸º <code>useMemo</code> ä¸èƒ½ä¿è¯è¢« memo çš„å€¼ä¸€å®šä¸ä¼šè¢«é‡è®¡ç®—ï¼Œè€Œ <code>useCreation</code> å¯ä»¥ä¿è¯è¿™ä¸€ç‚¹ã€‚</p> <p>è€Œç›¸æ¯”äº <code>useRef</code>ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>useCreation</code> åˆ›å»ºä¸€äº›å¸¸é‡ï¼Œè¿™äº›å¸¸é‡å’Œ <code>useRef</code> åˆ›å»ºå‡ºæ¥çš„ ref æœ‰å¾ˆå¤šä½¿ç”¨åœºæ™¯ä¸Šçš„ç›¸ä¼¼ï¼Œä½†å¯¹äºå¤æ‚å¸¸é‡çš„åˆ›å»ºï¼Œ<code>useRef</code> å´å®¹æ˜“å‡ºç°æ½œåœ¨çš„æ€§èƒ½éšæ‚£ã€‚</p> <p>useMemoizedFn</p> <p>æŒä¹…åŒ– function çš„ Hookï¼Œç†è®ºä¸Šï¼Œå¯ä»¥ä½¿ç”¨ useMemoizedFn å®Œå…¨ä»£æ›¿ useCallbackã€‚</p> <p>åœ¨æŸäº›åœºæ™¯ä¸­ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ useCallback æ¥è®°ä½ä¸€ä¸ªå‡½æ•°ï¼Œä½†æ˜¯åœ¨ç¬¬äºŒä¸ªå‚æ•° deps å˜åŒ–æ—¶ï¼Œä¼šé‡æ–°ç”Ÿæˆå‡½æ•°ï¼Œå¯¼è‡´å‡½æ•°åœ°å€å˜åŒ–ã€‚</p> <p>ä½¿ç”¨ useMemoizedFnï¼Œå¯ä»¥çœç•¥ç¬¬äºŒä¸ªå‚æ•° depsï¼ŒåŒæ—¶ä¿è¯å‡½æ•°åœ°å€æ°¸è¿œä¸ä¼šå˜åŒ–ã€‚</p> <p>useThrottleFn</p> <p>å¤„ç†å‡½æ•°èŠ‚æµçš„hooks</p> <p>useThrottleEffect</p> <p>ä¸º <code>useEffect</code> å¢åŠ èŠ‚æµçš„èƒ½åŠ›ã€‚</p> <p>useDebounceFn</p> <p>ç”¨æ¥å¤„ç†é˜²æŠ–å‡½æ•°çš„ Hookã€‚</p> <p><strong>é˜²æŠ–å®ç°</strong>ï¼šuseDebounceFnçš„å†…éƒ¨æ˜¯ä½¿ç”¨useMemo + lodashçš„debounceæ–¹æ³•</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>  <span class="token keyword">const</span> debounced <span class="token operator">=</span> <span class="token function">useMemo</span><span class="token punctuation">(</span>
    <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
      <span class="token function">debounce</span><span class="token punctuation">(</span>
        <span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token operator">:</span> Parameters<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token operator">:</span> ReturnType<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token keyword">return</span> fnRef<span class="token punctuation">.</span><span class="token function">current</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        wait<span class="token punctuation">,</span>
        options<span class="token punctuation">,</span>
      <span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>useDebounceEffect</p> <p>ä¸º <code>useEffect</code> å¢åŠ é˜²æŠ–çš„èƒ½åŠ›ã€‚</p> <p><strong>å®ç°</strong>ï¼šuseState + useDebounce</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>  <span class="token keyword">const</span> <span class="token punctuation">[</span>flag<span class="token punctuation">,</span> setFlag<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> <span class="token punctuation">{</span> run <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useDebounceFn</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">setFlag</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> deps<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">useUpdateEffect</span><span class="token punctuation">(</span>effect<span class="token punctuation">,</span> <span class="token punctuation">[</span>flag<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="domç›¸å…³-åŠŸèƒ½å‹hook"><a href="#domç›¸å…³-åŠŸèƒ½å‹hook" class="header-anchor">#</a> Domç›¸å…³ åŠŸèƒ½å‹Hook</h4> <p>useKeyPress</p> <p>ç›‘å¬é”®ç›˜æŒ‰é”®ï¼Œæ”¯æŒç»„åˆé”®ï¼Œæ”¯æŒæŒ‰é”®åˆ«åã€‚</p> <p>useLongPress</p> <p>ç›‘å¬ç›®æ ‡å…ƒç´ çš„é•¿æŒ‰äº‹ä»¶ã€‚</p> <p>useMouse</p> <p>ç›‘å¬é¼ æ ‡ä½ç½®</p> <p>useResponsive</p> <p>è·å–å±å¹•å®½åº¦å“åº”å¼ä¿¡æ¯ã€‚</p> <p>useSize</p> <p>ç›‘å¬ DOM èŠ‚ç‚¹å°ºå¯¸å˜åŒ–çš„ Hookã€‚</p> <p>useFavicon</p> <p>è®¾ç½®é¡µé¢çš„ faviconã€‚</p> <p>useInViewport</p> <p>è§‚å¯Ÿå…ƒç´ æ˜¯å¦åœ¨å¯è§åŒºåŸŸï¼Œä»¥åŠå…ƒç´ å¯è§æ¯”ä¾‹ã€‚</p> <p>useFocusWithin</p> <p>ç›‘å¬å½“å‰ç„¦ç‚¹æ˜¯å¦åœ¨æŸä¸ªåŒºåŸŸä¹‹å†…ï¼ŒåŒ css å±æ€§ focus-within</p> <p>useScroll</p> <p>ç›‘å¬å…ƒç´ çš„æ»šåŠ¨ä½ç½®ã€‚</p> <p>useFullscreen</p> <p>ç®¡ç† DOM å…¨å±çš„ Hookã€‚</p> <p>useLockFn</p> <p>ç»™å¼‚æ­¥å‡½æ•°åŠ å¹¶å‘é”ã€‚å¦‚æœå½“å‰å¼‚æ­¥å‡½æ•°æ­£åœ¨æ‰§è¡Œä¸­æ²¡æœ‰è¿”å›ï¼Œé‚£ä¹ˆä¸èƒ½æ‰§è¡Œï¼Œä¸Šä¸€æ¬¡å¼‚æ­¥å‡½æ•°æœ‰è¿”å›åæ‰èƒ½å†æ¬¡æ‰§è¡Œ</p> <h4 id="å¼€å‘è€…hook"><a href="#å¼€å‘è€…hook" class="header-anchor">#</a> å¼€å‘è€…hook</h4> <p>useWhyDidYouUpdate</p> <p>å¸®åŠ©å¼€å‘è€…æ’æŸ¥æ˜¯é‚£ä¸ªå±æ€§æ”¹å˜å¯¼è‡´äº†ç»„ä»¶çš„ rerenderã€‚</p> <p>useTrackedEffect</p> <p>è¿½è¸ªæ˜¯å“ªä¸ªä¾èµ–å˜åŒ–è§¦å‘äº† <code>useEffect</code> çš„æ‰§è¡Œã€‚</p> <h3 id="react-use"><a href="#react-use" class="header-anchor">#</a> react-use</h3> <h3 id="react-hooks"><a href="#react-hooks" class="header-anchor">#</a> react-hooks</h3> <p>https://github.com/ecomfe/react-hooks</p> <h3 id="usehooks"><a href="#usehooks" class="header-anchor">#</a> usehooks</h3> <p>https://github.com/uidotdev/usehooks</p> <p>https://usehooks-ts.com/react-hook/use-window-size</p> <h3 id="react-router"><a href="#react-router" class="header-anchor">#</a> react-router</h3> <p>useHistory useLocation useParams useRouteMatch</p> <div class="language-react extra-class"><pre class="language-text"><code>import {
  useHistory,
  useLocation,
  useParams,
  useRouteMatch,
} from &quot;react-router-dom&quot;

function HomeButton() {
  let history = useHistory();
  function haddleClick() {
    history.push(&quot;/home&quot;);
  }
  
  function usePageViews() {
      let location = useLocation();
    	React.useEffect(()=&gt;{
        ga.send([&quot;pageview&quot;, location.pathname]);
      },[location])
  }
  
  let { slug } = useParams();
  return &lt;div&gt;Now showing post {slug}&lt;/div&gt;
  
  let match = useRouteMatch(&quot;/blog/:slug&quot;)
  const match = useRouteMatch({
    path: &quot;/BLOG/:slug&quot;,
    strict: true,
    sensitive: true
  })
}
</code></pre></div><p>useRoutes</p> <div class="language-react extra-class"><pre class="language-text"><code>import * as React from &quot;react&quot;;
import { useRoutes } from &quot;react-router-dom&quot;;

function App() {
  let element = useRoutes([
    {
      path: &quot;/&quot;,
      element: &lt;Dashboard /&gt;,
      children: [
        {
          path: &quot;messages&quot;,
          element: &lt;DashboardMessages /&gt;,
        },
        { path: &quot;tasks&quot;, element: &lt;DashboardTasks /&gt; },
      ],
    },
    { path: &quot;team&quot;, element: &lt;AboutPage /&gt; },
  ]);

  return element;
}
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.3979e060.js" defer></script><script src="/assets/js/2.0f8cbb55.js" defer></script><script src="/assets/js/1.ff82b27c.js" defer></script><script src="/assets/js/68.58c65f95.js" defer></script>
  </body>
</html>
