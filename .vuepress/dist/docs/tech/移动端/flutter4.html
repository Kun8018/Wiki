<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>flutter移动开发（四）</title>
    <meta name="generator" content="VuePress 1.9.10">
    
    <meta name="description" content="">
    
    <link rel="preload" href="/assets/css/0.styles.0503e0f3.css" as="style"><link rel="preload" href="/assets/js/app.3979e060.js" as="script"><link rel="preload" href="/assets/js/2.0f8cbb55.js" as="script"><link rel="preload" href="/assets/js/1.ff82b27c.js" as="script"><link rel="preload" href="/assets/js/108.fe2c9c19.js" as="script"><link rel="prefetch" href="/assets/js/10.d9850768.js"><link rel="prefetch" href="/assets/js/100.a33654f4.js"><link rel="prefetch" href="/assets/js/101.d3bc1c79.js"><link rel="prefetch" href="/assets/js/102.02bbfd1e.js"><link rel="prefetch" href="/assets/js/103.c9de5560.js"><link rel="prefetch" href="/assets/js/104.7c2b76db.js"><link rel="prefetch" href="/assets/js/105.ea3ac79c.js"><link rel="prefetch" href="/assets/js/106.d54e3045.js"><link rel="prefetch" href="/assets/js/107.c142f695.js"><link rel="prefetch" href="/assets/js/109.59b55101.js"><link rel="prefetch" href="/assets/js/11.62caceeb.js"><link rel="prefetch" href="/assets/js/110.c657b6f8.js"><link rel="prefetch" href="/assets/js/111.4eadf9c5.js"><link rel="prefetch" href="/assets/js/112.fce38ecf.js"><link rel="prefetch" href="/assets/js/113.ee6322e2.js"><link rel="prefetch" href="/assets/js/114.1ed20fd8.js"><link rel="prefetch" href="/assets/js/115.aa405ee0.js"><link rel="prefetch" href="/assets/js/116.d1b4c413.js"><link rel="prefetch" href="/assets/js/117.965d1926.js"><link rel="prefetch" href="/assets/js/118.b1d5b9ca.js"><link rel="prefetch" href="/assets/js/119.e4e766bc.js"><link rel="prefetch" href="/assets/js/12.abd8d9de.js"><link rel="prefetch" href="/assets/js/120.f569b061.js"><link rel="prefetch" href="/assets/js/121.e3915f79.js"><link rel="prefetch" href="/assets/js/122.3a2b3d34.js"><link rel="prefetch" href="/assets/js/123.cbf985ea.js"><link rel="prefetch" href="/assets/js/124.c3d8b6fc.js"><link rel="prefetch" href="/assets/js/125.dfe970a3.js"><link rel="prefetch" href="/assets/js/126.f5165054.js"><link rel="prefetch" href="/assets/js/127.ffb31d35.js"><link rel="prefetch" href="/assets/js/128.bf7eb0b3.js"><link rel="prefetch" href="/assets/js/129.76b0ac54.js"><link rel="prefetch" href="/assets/js/13.763c094c.js"><link rel="prefetch" href="/assets/js/130.cb661ef6.js"><link rel="prefetch" href="/assets/js/131.b215b4cc.js"><link rel="prefetch" href="/assets/js/132.bdf6b89f.js"><link rel="prefetch" href="/assets/js/133.a13e43ca.js"><link rel="prefetch" href="/assets/js/134.f858c56e.js"><link rel="prefetch" href="/assets/js/135.0e05a297.js"><link rel="prefetch" href="/assets/js/136.ff47beeb.js"><link rel="prefetch" href="/assets/js/137.7dcf182f.js"><link rel="prefetch" href="/assets/js/138.dd2c3c8c.js"><link rel="prefetch" href="/assets/js/139.db36e4eb.js"><link rel="prefetch" href="/assets/js/14.784100b6.js"><link rel="prefetch" href="/assets/js/140.05811a56.js"><link rel="prefetch" href="/assets/js/141.32b8052b.js"><link rel="prefetch" href="/assets/js/142.2c061186.js"><link rel="prefetch" href="/assets/js/143.113df61a.js"><link rel="prefetch" href="/assets/js/144.2c01c336.js"><link rel="prefetch" href="/assets/js/145.a8fe7a8a.js"><link rel="prefetch" href="/assets/js/146.bb5b7e16.js"><link rel="prefetch" href="/assets/js/147.213b17a7.js"><link rel="prefetch" href="/assets/js/148.dd7a3258.js"><link rel="prefetch" href="/assets/js/149.b3f9adc5.js"><link rel="prefetch" href="/assets/js/15.3aa73286.js"><link rel="prefetch" href="/assets/js/150.4ab9a505.js"><link rel="prefetch" href="/assets/js/151.d04eb475.js"><link rel="prefetch" href="/assets/js/152.c547ae2c.js"><link rel="prefetch" href="/assets/js/153.3fa58002.js"><link rel="prefetch" href="/assets/js/154.cd2cc012.js"><link rel="prefetch" href="/assets/js/155.0160c441.js"><link rel="prefetch" href="/assets/js/16.7886627b.js"><link rel="prefetch" href="/assets/js/17.a4c76a6c.js"><link rel="prefetch" href="/assets/js/18.995eb54b.js"><link rel="prefetch" href="/assets/js/19.edc682a7.js"><link rel="prefetch" href="/assets/js/20.87ca556d.js"><link rel="prefetch" href="/assets/js/21.4b328dcc.js"><link rel="prefetch" href="/assets/js/22.91d15e78.js"><link rel="prefetch" href="/assets/js/23.17bfc3dd.js"><link rel="prefetch" href="/assets/js/24.c0d84a10.js"><link rel="prefetch" href="/assets/js/25.2717e191.js"><link rel="prefetch" href="/assets/js/26.3764ddb4.js"><link rel="prefetch" href="/assets/js/27.e98913ec.js"><link rel="prefetch" href="/assets/js/28.a4481108.js"><link rel="prefetch" href="/assets/js/29.3d82d38d.js"><link rel="prefetch" href="/assets/js/3.e2aae122.js"><link rel="prefetch" href="/assets/js/30.7e9979a2.js"><link rel="prefetch" href="/assets/js/31.fa479c29.js"><link rel="prefetch" href="/assets/js/32.901576de.js"><link rel="prefetch" href="/assets/js/33.8dafc45c.js"><link rel="prefetch" href="/assets/js/34.6bbddd9b.js"><link rel="prefetch" href="/assets/js/35.394c80b9.js"><link rel="prefetch" href="/assets/js/36.5246333d.js"><link rel="prefetch" href="/assets/js/37.49802bfd.js"><link rel="prefetch" href="/assets/js/38.36ae0914.js"><link rel="prefetch" href="/assets/js/39.791184a0.js"><link rel="prefetch" href="/assets/js/4.30c2ba05.js"><link rel="prefetch" href="/assets/js/40.eb1a9cc1.js"><link rel="prefetch" href="/assets/js/41.31179942.js"><link rel="prefetch" href="/assets/js/42.22c31ea4.js"><link rel="prefetch" href="/assets/js/43.e82e343d.js"><link rel="prefetch" href="/assets/js/44.95e68751.js"><link rel="prefetch" href="/assets/js/45.b99232d2.js"><link rel="prefetch" href="/assets/js/46.21e9dae9.js"><link rel="prefetch" href="/assets/js/47.e30bba7c.js"><link rel="prefetch" href="/assets/js/48.6c0d14cd.js"><link rel="prefetch" href="/assets/js/49.ed1b480b.js"><link rel="prefetch" href="/assets/js/5.c5fba3ad.js"><link rel="prefetch" href="/assets/js/50.f500b9ed.js"><link rel="prefetch" href="/assets/js/51.3671246f.js"><link rel="prefetch" href="/assets/js/52.7915148f.js"><link rel="prefetch" href="/assets/js/53.39ece5d9.js"><link rel="prefetch" href="/assets/js/54.358ca4aa.js"><link rel="prefetch" href="/assets/js/55.244837be.js"><link rel="prefetch" href="/assets/js/56.e7164f10.js"><link rel="prefetch" href="/assets/js/57.3c6f5aa2.js"><link rel="prefetch" href="/assets/js/58.84c83603.js"><link rel="prefetch" href="/assets/js/59.ec4edc7d.js"><link rel="prefetch" href="/assets/js/6.9184d4d1.js"><link rel="prefetch" href="/assets/js/60.c2346e02.js"><link rel="prefetch" href="/assets/js/61.8d99ca4c.js"><link rel="prefetch" href="/assets/js/62.f6bea4bf.js"><link rel="prefetch" href="/assets/js/63.410bfe1e.js"><link rel="prefetch" href="/assets/js/64.960d5951.js"><link rel="prefetch" href="/assets/js/65.e6a8895b.js"><link rel="prefetch" href="/assets/js/66.41092e16.js"><link rel="prefetch" href="/assets/js/67.062b95dc.js"><link rel="prefetch" href="/assets/js/68.58c65f95.js"><link rel="prefetch" href="/assets/js/69.d1e1b68b.js"><link rel="prefetch" href="/assets/js/7.85fc951e.js"><link rel="prefetch" href="/assets/js/70.8294a611.js"><link rel="prefetch" href="/assets/js/71.66e44dac.js"><link rel="prefetch" href="/assets/js/72.46bd34f2.js"><link rel="prefetch" href="/assets/js/73.7eb2e800.js"><link rel="prefetch" href="/assets/js/74.8e05f264.js"><link rel="prefetch" href="/assets/js/75.21e0b9b1.js"><link rel="prefetch" href="/assets/js/76.c2c92cec.js"><link rel="prefetch" href="/assets/js/77.799df679.js"><link rel="prefetch" href="/assets/js/78.1605b33c.js"><link rel="prefetch" href="/assets/js/79.659e7e78.js"><link rel="prefetch" href="/assets/js/80.6f99ca65.js"><link rel="prefetch" href="/assets/js/81.7a0caba9.js"><link rel="prefetch" href="/assets/js/82.19629840.js"><link rel="prefetch" href="/assets/js/83.29093f51.js"><link rel="prefetch" href="/assets/js/84.64568258.js"><link rel="prefetch" href="/assets/js/85.3d88e3b2.js"><link rel="prefetch" href="/assets/js/86.0a93f933.js"><link rel="prefetch" href="/assets/js/87.07c51a25.js"><link rel="prefetch" href="/assets/js/88.aa6be8e5.js"><link rel="prefetch" href="/assets/js/89.6ad93f1f.js"><link rel="prefetch" href="/assets/js/90.87c8c6e5.js"><link rel="prefetch" href="/assets/js/91.57c509b5.js"><link rel="prefetch" href="/assets/js/92.c8b02e25.js"><link rel="prefetch" href="/assets/js/93.fee86c6c.js"><link rel="prefetch" href="/assets/js/94.ab3bad19.js"><link rel="prefetch" href="/assets/js/95.cfaa79dc.js"><link rel="prefetch" href="/assets/js/96.c63afef5.js"><link rel="prefetch" href="/assets/js/97.123374a6.js"><link rel="prefetch" href="/assets/js/98.53cfb154.js"><link rel="prefetch" href="/assets/js/99.8fe1f067.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.5e19b665.js">
    <link rel="stylesheet" href="/assets/css/0.styles.0503e0f3.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <!----> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="概述"><a href="#概述" class="header-anchor">#</a> 概述</h2> <p>不知不觉已经第四篇了，这篇注重flutter全局观</p> <p></p> <h2 id="dart语法"><a href="#dart语法" class="header-anchor">#</a> Dart语法</h2> <h3 id="dart内置包"><a href="#dart内置包" class="header-anchor">#</a> dart内置包</h3> <div class="language-dart extra-class"><pre class="language-dart"><code><span class="token keyword">import</span> <span class="token string-literal"><span class="token string">'dart:core'</span></span><span class="token punctuation">;</span>
</code></pre></div><p>提供了小型但关键的内置功能，这个包库被自动导入每个dart程序</p> <div class="language-dart extra-class"><pre class="language-dart"><code><span class="token keyword">import</span> <span class="token string-literal"><span class="token string">'dart:async'</span></span><span class="token punctuation">;</span>
</code></pre></div><p>异步编程通常使用回调函数，dart提供其他方法：future和stream，dart:async库中包含了future和Stream的更多信息</p> <p>Future就像对未来某个时刻的结果的承诺。Stream是一种获取值序列(如事件)的方法。</p> <div class="language-dart extra-class"><pre class="language-dart"><code><span class="token keyword">import</span> <span class="token string-literal"><span class="token string">'dart:math'</span></span><span class="token punctuation">;</span>
</code></pre></div><p>dart:math库提供常见的函数，如正弦余弦、最大值最小值，pi和e等</p> <p>Api：https://api.dart.dev/stable/2.8.4/dart-math/dart-math-library.html</p> <div class="language-dart extra-class"><pre class="language-dart"><code><span class="token keyword">import</span> <span class="token string-literal"><span class="token string">'dart:convert'</span></span><span class="token punctuation">;</span>
</code></pre></div><p>jsonDecode将json编码的字符串解码为dart对象</p> <p>jsonEncode将受支持的Dart对象编码为json格式的字符串</p> <p>utf8.decode()将utf8编码的字节解码为dart字符串</p> <p>utf8.encode()将Dart字符串编码为utf8编码字节的列表:</p> <div class="language-dart extra-class"><pre class="language-dart"><code><span class="token keyword">import</span> <span class="token string-literal"><span class="token string">'dart:io'</span></span>
</code></pre></div><p>网络实现</p> <div class="language-dart extra-class"><pre class="language-dart"><code><span class="token keyword">var</span> httpClient <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HttpClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> uri <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Uri</span><span class="token punctuation">.</span><span class="token function">http</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> request <span class="token operator">=</span> <span class="token keyword">await</span> httpClient<span class="token punctuation">.</span><span class="token function">getUrl</span><span class="token punctuation">(</span>uri<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> response <span class="token operator">=</span> <span class="token keyword">await</span> request<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><h3 id="变量和基本类型"><a href="#变量和基本类型" class="header-anchor">#</a> 变量和基本类型</h3> <p>变量 var</p> <p>如果不希望变量修改，可以使用final或者const定义变量</p> <p>数字类型：int整数、double浮点数类型、num数字类型</p> <p>布尔类型</p> <p>枚举类型  enum</p> <p>List数组</p> <p>List,是泛型类型数据结构，支持任意数据类型的数组。默认定义方式为可扩展数组</p> <div class="language-dart extra-class"><pre class="language-dart"><code><span class="token comment">// 通过List对象定义int数组</span>
<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span>int<span class="token punctuation">&gt;</span></span> a <span class="token operator">=</span> <span class="token class-name">List</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 在Dart语言中new是可选的</span>
<span class="token comment">// 定义int数组</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span>int<span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 也可以通过指定List泛型类型定义数组.</span>
<span class="token comment">// 定义String数组</span>
<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> strs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string-literal"><span class="token string">&quot;字符串1&quot;</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">&quot;字符串2&quot;</span></span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">//创建固定长度的数组  </span>
<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span>int<span class="token punctuation">&gt;</span></span> fixedLengthList <span class="token operator">=</span> <span class="token class-name">List</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//合并数组</span>
<span class="token keyword">var</span> list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> list2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>list<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 将list数组的所有元素一个个展开来，插入到list2中，...为伸展运算符</span>
<span class="token comment">// 往数组尾巴添加一个元素</span>
<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span>
a<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 通过数组下标，读取第一个元素， 数组下标从0开始计算,固定长度数组只能通过下面的下标的方式读写数组，而且数组下标不能超过数组长度。</span>
<span class="token keyword">var</span> data <span class="token operator">=</span> a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">// 修改第一个元素的值</span>
a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">101</span><span class="token punctuation">;</span>
<span class="token comment">// 在数组0位置，插入100</span>
a<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 删除一个数据</span>
a<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 清空List，删除所有数据</span>
a<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//获取数组大小</span>
<span class="token function">print</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>length<span class="token punctuation">)</span>
<span class="token comment">//排序</span>
a<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//默认从小到大排序</span>
<span class="token comment">//查找数据元素</span>
<span class="token keyword">var</span> pos <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token comment">//数组中第5个位置元素的值</span>
<span class="token comment">//判断数组是否包含某元素，返回布尔值</span>
<span class="token keyword">var</span> v <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Set集合</p> <p>Set是无序集合类型，Set跟List都能保存一组数据，区别就是Set的元素都是唯一的。</p> <div class="language-dart extra-class"><pre class="language-dart"><code><span class="token comment">//初始化set</span>
<span class="token keyword">var</span> halogens <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string-literal"><span class="token string">'fluorine'</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">'chlorine'</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">'bromine'</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">'iodine'</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">'astatine'</span></span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> names <span class="token operator">=</span> <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//set集合中添加一个元素</span>
names<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;tizi365&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//将集合类型的数据导入到另一个Set中</span>
<span class="token keyword">var</span> titles <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string-literal"><span class="token string">&quot;Dart语言教程&quot;</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">&quot;Flutter教程&quot;</span></span><span class="token punctuation">]</span><span class="token punctuation">;</span>
names<span class="token punctuation">.</span><span class="token function">addAll</span><span class="token punctuation">(</span>titles<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 删除Set元素</span>
names<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;Dart语言教程&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 删除所有Set元素</span>
names<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//获取set集合元素个数</span>
names<span class="token punctuation">.</span>length
<span class="token comment">//检测set中是否含有元素</span>
names<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;tizi&quot;</span></span><span class="token punctuation">)</span>
<span class="token comment">// 循环遍历Set元素</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> x <span class="token keyword">in</span> names<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">print</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 打印元素</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Map类型</p> <p>Map是一种哈希类型数据，map类型的数据都是由key和value两个值组成，key是唯一的，value不必唯一，key和value可以为相同类型，也可以将key和value分别指定为别的类型</p> <div class="language-dart extra-class"><pre class="language-dart"><code><span class="token comment">//初始化map</span>
<span class="token comment">//直接赋值</span>
<span class="token keyword">var</span> gifts <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token string-literal"><span class="token string">'first'</span></span><span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">'partridge'</span></span><span class="token punctuation">,</span>
  <span class="token string-literal"><span class="token string">'second'</span></span><span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">'turtledoves'</span></span><span class="token punctuation">,</span>
  <span class="token string-literal"><span class="token string">'fifth'</span></span><span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">'golden rings'</span></span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> data <span class="token operator">=</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> int<span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//指定类型</span>
<span class="token keyword">var</span> nobleGases <span class="token operator">=</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//默认为&lt;Object,Object&gt;</span>
</code></pre></div><p>修改map</p> <div class="language-dart extra-class"><pre class="language-dart"><code><span class="token comment">//添加数据</span>
data<span class="token punctuation">[</span><span class="token string-literal"><span class="token string">&quot;key1&quot;</span></span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string-literal"><span class="token string">&quot;value1&quot;</span></span><span class="token punctuation">;</span>   
data<span class="token punctuation">[</span><span class="token string-literal"><span class="token string">&quot;key2&quot;</span></span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string-literal"><span class="token string">&quot;value2&quot;</span></span><span class="token punctuation">;</span>
<span class="token comment">//查询数据</span>
<span class="token keyword">var</span> v <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string-literal"><span class="token string">&quot;tizi&quot;</span></span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//根据key为tizi的value返回给v，如果没有默认为null</span>
<span class="token comment">//更新数据</span>
data<span class="token punctuation">[</span><span class="token string-literal"><span class="token string">&quot;tizi&quot;</span></span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1001</span><span class="token punctuation">;</span>
<span class="token comment">//删除map数据</span>
data<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;tizi&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//根据key指定删除数据</span>
<span class="token comment">//删除map所有数据</span>
data<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//获取map大小</span>
<span class="token keyword">var</span> len <span class="token operator">=</span> data<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
<span class="token comment">//遍历数据</span>
data<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> v<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">// 通过给forEach函数传递一个闭包函数遍历map</span>
    <span class="token comment">// 这个闭包函数有两个参数: k 代表map的key, v 代表map的value值</span>
    <span class="token function">print</span><span class="token punctuation">(</span>k <span class="token operator">+</span> <span class="token string-literal"><span class="token string">&quot; = &quot;</span></span> <span class="token operator">+</span> v<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 打印数据</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>final表示这个变量不能在发生更改，但是这个初始化的值在编译时是不确定的，在运行时确定其值，且不能更改，如http接口、三方库的随机数据</p> <p>const是在定义时初始化</p> <h3 id="泛型"><a href="#泛型" class="header-anchor">#</a> 泛型</h3> <p>类泛型</p> <div class="language-dart extra-class"><pre class="language-dart"><code><span class="token comment">//定义类的泛型很简单，只需要在类名后加: &lt;T&gt;；如果需要多个泛型类型参数，可以在尖括号中追加，用逗号分隔</span>
<span class="token keyword">class</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
  <span class="token class-name">T</span> element<span class="token punctuation">;</span>

  <span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">T</span> element<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//...</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>函数泛型</p> <div class="language-dart extra-class"><pre class="language-dart"><code><span class="token comment">//定义函数的泛型</span>
<span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">T</span> elememt<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//函数参数类型为泛型类型</span>
    <span class="token comment">//...</span>
<span class="token punctuation">}</span>

<span class="token class-name">T</span> <span class="token function">elementAt</span><span class="token punctuation">(</span>int index<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//函数参数返回值类型为泛型类型</span>
    <span class="token comment">//...</span>
<span class="token punctuation">}</span>

<span class="token class-name">E</span> <span class="token function">transform</span><span class="token punctuation">(</span><span class="token class-name">R</span> data<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//函数参数类型和函数参数返回值类型均为泛型类型</span>
   <span class="token comment">//... </span>
<span class="token punctuation">}</span>
</code></pre></div><p>集合泛型</p> <p>Map&lt;string,int&gt;={}</p> <h3 id="运算符"><a href="#运算符" class="header-anchor">#</a> 运算符</h3> <p>is对象是该类型，返回true</p> <p>is！对象不是该类型返回false</p> <p>as类型转换</p> <h3 id="引入与导出"><a href="#引入与导出" class="header-anchor">#</a> 引入与导出</h3> <p>引入分为引入内置库、引入pub包管理器提供的库、引入本地文件(自定义的库)</p> <p>内置库随flutter sdk安装到本地，</p> <p>dart语言使用pub管理第三方开源包，</p> <p>导入本地包时直接通过路径访问dart脚本</p> <p>指定库的别名</p> <p>如果导入的两个包，包含了同名的类或者函数，就会出现命名冲突，因此提供别名机制。</p> <div class="language-dart extra-class"><pre class="language-dart"><code><span class="token keyword">import</span> <span class="token string-literal"><span class="token string">'dart:math'</span></span> <span class="token operator">as</span> math<span class="token punctuation">;</span><span class="token comment">// 使用 as 关键词，指定包的别名,通过别名访问包中的方法</span>
</code></pre></div><p>部分导入</p> <p>分为只导入需要的部分和隐藏不需要的部分两种</p> <div class="language-dart extra-class"><pre class="language-dart"><code><span class="token keyword">import</span> <span class="token string-literal"><span class="token string">'package:lib1/lib1.dart'</span></span> <span class="token keyword">show</span> foo<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string-literal"><span class="token string">'package:lib1/lib1.dart'</span></span> <span class="token keyword">hide</span> foo<span class="token punctuation">;</span>
</code></pre></div><p>延迟加载：</p> <p>在需要的时候进行加载，可以减少app启动时间</p> <div class="language-dart extra-class"><pre class="language-dart"><code><span class="token keyword">import</span> <span class="token string-literal"><span class="token string">'package:deferred/hello.dart'</span></span> <span class="token keyword">deferred</span> <span class="token operator">as</span> hello<span class="token punctuation">;</span>
    
<span class="token function">greet</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">async</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> hello<span class="token punctuation">.</span><span class="token function">loadLibrary</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    hello<span class="token punctuation">.</span><span class="token function">printGreeting</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>flutter对于平台级的包是plugin，主要是与平台相关的功能</p> <p>flutter对于纯dart开发的包的package，与平台无关，第三方包的前缀为package</p> <p>导出更大的库 export</p> <p>library</p> <h3 id="类"><a href="#类" class="header-anchor">#</a> 类</h3> <p>默认类的成员属性和方法都是共有的，以下划线 ( _ ) 开头命名的属性和方法代表私有（private）成员属性，</p> <p>类中跟类名同名的方法，为构造方法，如果没有自定义构造方法，会自动生成一个不带参数的默认构造方法</p> <div class="language-dart extra-class"><pre class="language-dart"><code><span class="token comment">//实例化</span>
<span class="token keyword">var</span> p <span class="token operator">=</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;tizi&quot;</span></span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//通过.调用对象中的属性和方法</span>
<span class="token keyword">var</span> ret <span class="token operator">=</span> p<span class="token punctuation">.</span><span class="token function">greet</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;dacui&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Factory构造方法类似设计模式中的工厂模式，用来创建对象。factory 构造方法只能访问静态属性和静态成员方法，因此不能访问this引用。</p> <p>extends是继承，调用父类的方法要用<code>super</code>，重写父类的方法要用<code>@override</code>，子类中实现父类的方法时要加<code>override</code></p> <p>flutter中只支持单继承，且构造函数不能继承，Dart语言中一个类只能继承一个父类，但是Dart语言提供了mixins机制，可以复用多个类，达到类似多继承的效果</p> <div class="language-dart extra-class"><pre class="language-dart"><code><span class="token comment">// 定一个父类</span>
<span class="token keyword">class</span> <span class="token class-name">Television</span> <span class="token punctuation">{</span>
  <span class="token keyword">void</span> <span class="token function">turnOn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;i am father&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 定义一个子类, 继承Television父类</span>
<span class="token keyword">class</span> <span class="token class-name">SmartTelevision</span> <span class="token keyword">extends</span> <span class="token class-name">Television</span> <span class="token punctuation">{</span>
  <span class="token comment">// 重写父类的方法</span>
  <span class="token keyword">void</span> <span class="token function">turnOn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;i am son&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>implement接口</p> <p>flutter没有专门的接口，每一个类有一个隐形的接口，接口中包含类中所有变量和方法，可以拥有父类的api，类bimplement类a</p> <div class="language-dart extra-class"><pre class="language-dart"><code><span class="token keyword">class</span> <span class="token class-name">Point</span> <span class="token keyword">implements</span> <span class="token class-name">Comparable</span><span class="token punctuation">,</span> <span class="token class-name">Location</span> <span class="token punctuation">{</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">}</span>
</code></pre></div><p>抽象类是不能实例化的类，一般都是用来定义接口，抽象方法就是没有实现的方法。只能继承或写接口</p> <div class="language-dart extra-class"><pre class="language-dart"><code><span class="token comment">// 使用abstract关键词修饰的类，就是抽象类</span>
<span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">Doer</span> <span class="token punctuation">{</span>
  <span class="token comment">// 定义个抽象方法，这个方法我们没有实现具体的功能。</span>
  <span class="token keyword">void</span> <span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">EffectiveDoer</span> <span class="token keyword">extends</span> <span class="token class-name">Doer</span> <span class="token punctuation">{</span>
  <span class="token comment">// 实现抽象类的抽象方法</span>
  <span class="token keyword">void</span> <span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;实现了抽象方法doSomething&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>混合mixins的对象是类，可以混合多个</p> <p>dart中..符号（两个连点）代表连续调用函数或方法，属于流式编程。</p> <h3 id="函数"><a href="#函数" class="header-anchor">#</a> 函数</h3> <p>函数允许定义0个或多个参数，也可以使用命名参数，就是在函数调用传参的时候，直接根据参数名传递参数，忽略参数定义的顺序。</p> <p>命名参数用花括号{}表示，命名参数定义后，调用函数时可以不传参，不传参的时候默认参数为null，也可以自定义默认参数</p> <div class="language-dart extra-class"><pre class="language-dart"><code><span class="token comment">// 参数包括在 花括号{} 之间</span>
<span class="token keyword">void</span> <span class="token function">enableFlags</span><span class="token punctuation">(</span><span class="token punctuation">{</span>bool bold<span class="token punctuation">,</span> bool hidden<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">// 忽略函数代码</span>
<span class="token punctuation">}</span>
<span class="token comment">// 调用函数，多个参数使用逗号分隔，参数顺序无关紧要。</span>
<span class="token function">enableFlags</span><span class="token punctuation">(</span>hidden<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> bold<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>闭包函数又叫匿名函数，就是没有函数名的函数，直接将函数赋值给一个变量，通过变量名调用函数即可。</p> <div class="language-dart extra-class"><pre class="language-dart"><code><span class="token keyword">var</span> f <span class="token operator">=</span> <span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> a <span class="token operator">&gt;</span> b<span class="token punctuation">;</span>  <span class="token comment">// 返回bool类型参数</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// 调用闭包函数</span>
<span class="token function">f</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>闭包函数的一种是箭头函数，如果闭包函数只有一个表达式的时候，可以使用箭头函数简写。</p> <div class="language-dart extra-class"><pre class="language-dart"><code><span class="token comment">//上面的函数等价于</span>
<span class="token keyword">var</span> f <span class="token operator">=</span> <span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> a <span class="token operator">&gt;</span> b<span class="token punctuation">;</span>
</code></pre></div><p>闭包函数内部可以引用包含闭包函数的所有层级作用域中的变量，与闭包函数调用的位置无关。</p> <h3 id="值传递"><a href="#值传递" class="header-anchor">#</a> 值传递</h3> <p>dart是值传递而非引用传递</p> <p>值传递和引用传递属于函数调用时参数的求值策略，是用于区分两种内存分配方式，值传递在调用栈上分配，引用传递在堆上分配。</p> <p>值传递是原来函数的一份拷贝，拷贝的是值，而引用传递拷贝的是指针地址，可以改变值或者指针地址，</p> <p>除了c、c#、c++，其他的语言如java、oc、Dart等都是值传递。值传递用起来更简单，同时还能规避很多因为此而产生的不必要的问题</p> <h3 id="flutter页面间传参"><a href="#flutter页面间传参" class="header-anchor">#</a> flutter页面间传参</h3> <p>1.通过定义构造方法传值</p> <p>需要在接收数据的页面事先定义好构造方法，构造方法中是要接收的参数。</p> <p>2.通过指定路由传递参数</p> <p>在Flutter中我们可以把要传递的参数放到<strong>Navigator</strong>中，然后传递给指定的路由，在接收的页面提取出需要的参数即可，这种方式相比方式一更加灵活一些。</p> <p>3.通过onGenerateRoute提取参数后传给相应Widget</p> <p>这种方式可以看做是前两种方式的结合体，我们可以在onGenerateRoute提取参数，然后传递给指定的Widget。</p> <h3 id="key"><a href="#key" class="header-anchor">#</a> Key</h3> <p>flutter受到react或vue启发，每个wideget的构建方法都会有一个key的参数可选，用key标识元素，当移除或添加元素时可以准确识别</p> <p>Key对于每个元素是独一无二的</p> <p>ObjectKey与ValueKey</p> <p>GlobalKey的使用场景是从父组件跨子Widget来传递状态时使用</p> <h3 id="future异步"><a href="#future异步" class="header-anchor">#</a> future异步</h3> <p>dart是单线程语言，flutter中的异步操作是通过单线程再通过调度任务优先级执行的，也就是future。future是对zone的封装</p> <p>future与await、async 的区别是future提供了链式调用，future中的.then没有创建新的Event，而是一个个普通函数，全部执行完在开始执行下一个future</p> <p>创建future</p> <div class="language-dart extra-class"><pre class="language-dart"><code><span class="token keyword">void</span> <span class="token function">testFuture</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">Future</span> future <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Future</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    future<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>_<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;then&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;whenComplete&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catchError</span><span class="token punctuation">(</span><span class="token punctuation">(</span>_<span class="token punctuation">)</span><span class="token punctuation">{</span>
        
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>多个future的执行顺序</p> <p>future的执行顺序为future在EventQueue中的排列顺序，当需要延迟执行时，采用future.delay()执行，放在最后执行</p> <p>future如果执行完才添加.then函数，则该任务会被放到MicroTask，当前future执行完才去执行microtask，microtask执行完才去下一个future</p> <h3 id="flutter-与native通信"><a href="#flutter-与native通信" class="header-anchor">#</a> Flutter 与Native通信</h3> <p>Flutter中定义了三种不同类型的channel，分别是</p> <p>BasicMessageChannel:用于传递字符串和半结构化的信息</p> <p>MethodChannel：传递方法调用</p> <p>EventChannel：用于数据流通信</p> <h3 id="isolate多线程"><a href="#isolate多线程" class="header-anchor">#</a> Isolate多线程</h3> <p>flutter中isolate是有自己的内存和单线程控制的运行实体，isolate类似于线程，默认情况Dart启动一个Isolate，main函数就是他的入口。运行中的flutter程序是由一个或多个isolate组成的，通常情况下程序运行在main isolate中。</p> <p>isolate是通过flutter Engine层面的线程实现的。多个isolate无法共享内存，必须通过api进行通信。</p> <p>执行完后检查并执行Microtask Queue，通常使用scheduleMicrotask将事件添加到MicroTask Queue</p> <p>最后执行EventQueue队列中的代码，通常使用future向EventQueue加入时间，也可以使用async和await添加事件</p> <p>针对比较消耗CPU的任务，最好创建一个新的 Isolate 去处理，避免阻塞主 Isolate （也就是主线程），这样可以利用设备的多核特性。</p> <div class="language-dart extra-class"><pre class="language-dart"><code><span class="token comment">// 导入isolate包</span>
<span class="token keyword">import</span> <span class="token string-literal"><span class="token string">'dart:isolate'</span></span><span class="token punctuation">;</span>

<span class="token keyword">void</span> main asyc<span class="token punctuation">{</span>
  <span class="token comment">// 创建一个ReceivePort用于接收消息</span>
    <span class="token keyword">var</span> recv <span class="token operator">=</span> <span class="token class-name">ReceivePort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 通过Isolate.spawn静态函数，创建一个新的Isolate</span>
  <span class="token class-name">Isolate</span><span class="token punctuation">.</span>spawn<span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>subTask<span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">&quot;Task1 parameter&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//</span>
  <span class="token comment">// 泛型参数为SendPort，入口函数为subTask</span>
  <span class="token class-name">Isolate</span><span class="token punctuation">.</span>spawn<span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SendPort</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>subTask<span class="token punctuation">,</span> recv<span class="token punctuation">.</span>sendPort<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 入口函数，参数类型由上面的spawn的泛型参数决定。</span>
<span class="token keyword">void</span> <span class="token function">subTask</span><span class="token punctuation">(</span><span class="token class-name">String</span> msg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;subTask recv: </span><span class="token interpolation"><span class="token punctuation">$</span><span class="token expression">msg</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// Isolate入口函数定义，接收一个SendPort对象作为参数</span>
<span class="token keyword">void</span> <span class="token function">subTask</span><span class="token punctuation">(</span><span class="token class-name">SendPort</span> port<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 使用SendPort发送一条字符串消息</span>
	port<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;subTask Result.&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>多个Isolate 之间只能通过消息通讯，主要通过ReceivePort和SendPort两个类处理消息通讯。</p> <p>ReceivePort 负责接收 SendPort 发送的消息， SendPort 和 ReceivePort 是捆绑关系， SendPort 是由 ReceivePort 创建的。</p> <h3 id="事件流"><a href="#事件流" class="header-anchor">#</a> 事件流</h3> <p>Stream是dart语言自带的，可以把stream想象成管道，只从一端流入数据，通过管道从另一端流出数据。通过StreamController控制stream，</p> <p>Stream支持任何数据的传输，包括基本值、对象、事件、集合等。传输数据时可以通过listen监听来自StreamController的属性，监听之后可以通过StreamSubscription订阅对象并接受stream发送数据变更的通知。</p> <p>Stream也是异步处理的核心，与Future相比，Future表示将来一次异步获得的数据，而Stream是多次异步获取的数据。Future是返回一次值，Stream返回多次值。Stream有StreamBuilder负责监听Stream，当Stream数据流出时会自动重新构建组件，并通过Builder进行回调。</p> <h2 id="flutter底层原理"><a href="#flutter底层原理" class="header-anchor">#</a> Flutter底层原理</h2> <h3 id="flutter开发概述-拷贝"><a href="#flutter开发概述-拷贝" class="header-anchor">#</a> flutter开发概述（拷贝）</h3> <p>flutter的开发通过继承无状态的<code>StatelessWidget</code>控件还有有状态的<code>StatefulWidget</code>，然后通过嵌套<code>Widget</code>下的<code>child/children</code>，在对应的<code>Widget</code>下面建立控件及控件样式</p> <p>flutter中container控件就是结合<code>Align</code>、<code>Padding</code>、<code>DecoratedBox</code>、<code>ConstrainedBox</code>、<code>Transform</code>等组合而成，形成编辑好的业务模板</p> <p>对于状态管理，flutter通过继承statefulwidget，然后在state对象内通过变量访问和setstate出发更新</p> <p>flutter中存在Widget、Element、RenderObject、Layer四棵树，Element与RenderObject是一一对应的关系，与Widget是多对一的关系，</p> <h3 id="flutter执行原理"><a href="#flutter执行原理" class="header-anchor">#</a> flutter执行原理</h3> <p>flutter ui是直接通过skia渲染的。</p> <p>flutter内部执行事件循环机制。App执行main函数时，优先处理microtask queue，直到队列为空，microtask queue为空后开始处理event queue。每执行一次event，又会判断此时新的microytask queue是否为空，如果有再取出执行。执行microtask queue时eventqueue会被阻塞，直到再次为空。</p> <p>当microtask queue和event queue都为空时，App正常退出。</p> <p>microtask queue中尽量避免任务太多或者长时间处理，否则会使App的绘制和交互等行为卡住，因此绘制和交互这些作为event存放在event queue中。</p> <h3 id="flutter渠道"><a href="#flutter渠道" class="header-anchor">#</a> flutter渠道</h3> <p>flutter定义了master、beta、dev、stable四个渠道</p> <p>master为最新的channel</p> <p>dev为当月最新且充分测试的channel</p> <p>beta为每月最新且充分测试后的channel</p> <p>stable为当月最稳定的channel</p> <p>稳定性依次提高</p> <h3 id="生命周期"><a href="#生命周期" class="header-anchor">#</a> 生命周期</h3> <p>生命周期存在于有状态组件statefulwidget中</p> <p><code>createState()</code>创建一个StatefulWidget时立即调用，当要创建新的 StatefulWidget 的时候，会立即执行 createState，而且只执行一次，createState 必须要实现：</p> <p><code>initState()</code>此方法只会调用一次，初始化state，将state与对应的Buildcontext产生关联,必须调用super.initState()。在此方法内注册streams ChangeNotifiers或其他会改变的数据的监听</p> <p><code>didChangeDependencies()</code>state的依赖对象发生变化时调用该方法，同时build()方法会被调用</p> <p><code>build()</code>这个方法经常被调用，build 是用来创建 Widget 的，但因为 build 在每次界面刷新的时候都会调用，所以不要在 build 里写业务逻辑，可以把业务逻辑写到你的 StatelessWidget 的构造函数里。</p> <p><code>didUpdateWidge</code>当widget的状态变化时调用，一般不会用到，只有在使用 key 对 Widget 进行复用的时候才会调用。</p> <p><code>deactivate()</code>当切换页面时会调用该方法</p> <p><code>dispose()</code>widget销毁前调用该方法。当 View 不需要再显示，从渲染树中移除的时候，State 就会永久的从渲染树中移除，就会调用 <strong>dispose</strong> 生命周期，这时候就可以在 <strong>dispose</strong> 里做一些取消监听、动画的操作，和 <strong>initState</strong> 是相反的。</p> <p><code>setState()</code>通知组件刷新</p> <div class="language-dart extra-class"><pre class="language-dart"><code><span class="token metadata function">@override</span>
<span class="token function">initState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">initState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>App生命周期</p> <p>想知道flutterapp是在前台还是后台等，需要了解app生命周期，使用<strong>WidgetsBindingObserver</strong> ，</p> <p>在首页mix<strong>WidgetsBindingObserver</strong>类，同时初始化监听和移除，</p> <div class="language-dart extra-class"><pre class="language-dart"><code><span class="token keyword">class</span> _MyHomePageState <span class="token keyword">extends</span> <span class="token class-name">State</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">MyHomePage</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">with</span> <span class="token class-name">WidgetsBindingObserver</span> <span class="token punctuation">{</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
  <span class="token metadata function">@override</span>
  <span class="token keyword">void</span> <span class="token function">initState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">initState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">WidgetsBinding</span><span class="token punctuation">.</span>instance<span class="token punctuation">.</span><span class="token function">addObserver</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token metadata function">@override</span>
  <span class="token keyword">void</span> <span class="token function">dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// TODO: implement dispose</span>
    <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">WidgetsBinding</span><span class="token punctuation">.</span>instance<span class="token punctuation">.</span><span class="token function">removeObserver</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token metadata function">@override</span>
<span class="token keyword">void</span> <span class="token function">didChangeAppLifecycleState</span><span class="token punctuation">(</span><span class="token class-name">AppLifecycleState</span> state<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">didChangeAppLifecycleState</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>state <span class="token operator">==</span> <span class="token class-name">AppLifecycleState</span><span class="token punctuation">.</span>paused<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// went to Background</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>state <span class="token operator">==</span> <span class="token class-name">AppLifecycleState</span><span class="token punctuation">.</span>resumed<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// came back to Foreground</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>AppLifecycleState 就是 App 的生命周期，有：</p> <ul><li>resumed</li> <li>inactive</li> <li>paused</li> <li>suspending</li></ul> <h2 id="在android程序中插入flutter组件"><a href="#在android程序中插入flutter组件" class="header-anchor">#</a> 在Android程序中插入flutter组件</h2> <h2 id="在ios中插入flutter组件"><a href="#在ios中插入flutter组件" class="header-anchor">#</a> 在IOS中插入flutter组件</h2> <h2 id="音视频"><a href="#音视频" class="header-anchor">#</a> 音视频</h2> <p>对于flutter或者ios、android开发，在会写界面的基础上，在音视频、性能优化、监控、热修插件、动画效果、渲染等有深入就会很抢手。</p> <p>音视频基础</p> <p>视频流从加载到播放一般经过解协议、解封装、解编码等过程</p> <p>视频封装协议是指我们常见的mp4、avi、rmvb、mkv、flv等常见后缀格式，在传输过程中把音频和视频都打包在一起的封装</p> <p>流媒体协议一般有http、rtsp、RTMP等，最常见的就说http网络协议，RTSP和RTMP一般用于直播流或远程监控。</p> <p>对于编码，音频编码是指音频数据的编码方式，有mp3、pcm、aac、ac-3等，数据大小按采样率<em>声道数</em>样本格式计算。一般来说，wav/pcm编码的音频质量比较好，体积也会比较大，MP3有损压缩会在保证音频质量的同时压缩体积，aac也是有损压缩</p> <p>视频编码是图像的编码方式，有h263、h264、h265（HEVC）、MPEG-2、MPEG-4等，</p> <p>音视频开发接sdk和视频源url，确认自己需要支持的封装协议、视频编码和音频编码。如果允许客户上传，最好在服务端提供转格式与编码率等功能</p> <p>ffmpeg</p> <h2 id="flutter-web"><a href="#flutter-web" class="header-anchor">#</a> Flutter Web</h2> <p>flutterweb要求flutter版本大于1.5.4</p> <p>安装webdev工具</p> <div class="language-dart extra-class"><pre class="language-dart"><code>flutter packages pub global activate webdev
</code></pre></div><p>如果提示出错安装stagehand，输入命令</p> <div class="language-dart extra-class"><pre class="language-dart"><code>flutter packages pub global activate stagehand 
</code></pre></div><p>以git方式在pubspec.yaml中引入web库</p> <div class="language-dart extra-class"><pre class="language-dart"><code>dependencies<span class="token punctuation">:</span>
     flutter_web<span class="token punctuation">:</span> any
     flutter_web_ui<span class="token punctuation">:</span> any
 
dev_dependencies<span class="token punctuation">:</span>
     builder_runner<span class="token punctuation">:</span> <span class="token operator">^</span><span class="token number">1.4</span><span class="token number">.0</span>
     builder_web_compilers<span class="token punctuation">:</span> <span class="token operator">^</span><span class="token number">1.4</span><span class="token number">.0</span>   
     
dependency_overrides<span class="token punctuation">:</span>
     flutter_web<span class="token punctuation">:</span>
       git<span class="token punctuation">:</span>
         url<span class="token punctuation">:</span> https<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>github<span class="token punctuation">.</span>com<span class="token operator">/</span>flutter<span class="token operator">/</span>flutter_web
         path<span class="token punctuation">:</span> packages<span class="token operator">/</span>flutter_web
     flutter_web_ui<span class="token punctuation">:</span>
       git<span class="token punctuation">:</span>
         url<span class="token punctuation">:</span> https<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>github<span class="token punctuation">.</span>com<span class="token operator">/</span>flutter<span class="token operator">/</span>flutter_web
         path<span class="token punctuation">:</span> packages<span class="token operator">/</span>flutter_web_ui
</code></pre></div><p>热更新</p> <div class="language-dart extra-class"><pre class="language-dart"><code>webdev serve <span class="token operator">--</span>auto restart
</code></pre></div><p>输出静态文件</p> <div class="language-dart extra-class"><pre class="language-dart"><code>webdev build
</code></pre></div><h3 id="dart2js"><a href="#dart2js" class="header-anchor">#</a> dart2js</h3> <h2 id="flutter-windows"><a href="#flutter-windows" class="header-anchor">#</a> Flutter Windows</h2> <p>开启windows支持</p> <div class="language-dart extra-class"><pre class="language-dart"><code>flutter config <span class="token operator">--</span>enable<span class="token operator">-</span>windows<span class="token operator">-</span>desktop
</code></pre></div><p>windows应用编译需要visual studio工具</p> <h3 id="窗口尺寸"><a href="#窗口尺寸" class="header-anchor">#</a> 窗口尺寸</h3> <div class="language-dart extra-class"><pre class="language-dart"><code><span class="token keyword">import</span> <span class="token string-literal"><span class="token string">'package:window_size/window_size.dart'</span></span> <span class="token operator">as</span> window_size
</code></pre></div><h3 id="file-chooser"><a href="#file-chooser" class="header-anchor">#</a> file_chooser</h3> <h2 id=""><a href="#" class="header-anchor">#</a></h2> <p></p> <h2 id="-2"><a href="#-2" class="header-anchor">#</a></h2></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.3979e060.js" defer></script><script src="/assets/js/2.0f8cbb55.js" defer></script><script src="/assets/js/1.ff82b27c.js" defer></script><script src="/assets/js/108.fe2c9c19.js" defer></script>
  </body>
</html>
